fviz_eig(PCA.DATA, addlabels=T, ylim = c(0,40))
get_eigenvalue(PCA.DATA)
fviz_eig(PCA.DATA, addlabels=T, ylim = c(0,40))
get_eigenvalue(PCA.DATA.NOSENT)
fviz_eig(PCA.DATA.NOSENT, addlabels=T, ylim = c(0,40))
fviz_contrib(PCA.DATA, choice="var", axes = 1, top = 20)
1/8
fviz_contrib(PCA.DATA, choice="var", axes = 1, top = 12.5)
fviz_contrib(PCA.DATA, choice="var", axes = 2, top = 12.5)
fviz_contrib(PCA.DATA, choice="var", axes = 3, top = 12.5)
fviz_contrib(PCA.DATA, choice="var", axes = 4, top = 12.5)
1/7
fviz_contrib(PCA.DATA.NOSENT, choice="var", axes = 1, top = 14.29)
fviz_contrib(PCA.DATA.NOSENT, choice="var", axes = 2, top = 14.29)
fviz_contrib(PCA.DATA.NOSENT, choice="var", axes = 3, top = 14.29)
DATA<-read.csv("DATA.csv")
DATA$ID<-as.factor(DATA$ID)
DATA$ASIN_PROPORTION<-asin(sqrt(DATA$BEHAVIOR_PROPORTION))
str(DATA)
PCA.DATA.SHEET<-DATA[,c(5,7,10,14,16,18,20,22,38)]
head(PCA.DATA.SHEET)
str(PCA.DATA.SHEET)
PCA.DATA.SHEET<-DATA[,c(5,7,10,14,16,18,20,22,39)]
head(PCA.DATA.SHEET)
str(PCA.DATA.SHEET)
PCA.DATA.SHEET<-DATA[,c(5,7,10,14,16,18,22,24,39)]
head(PCA.DATA.SHEET)
str(PCA.DATA.SHEET)
PCA.DATA<-PCA(PCA.DATA.SHEET)
PCA.DATA<-PCA(PCA.DATA.SHEET)
PCA.DATA.NOSENT<-PCA(PCA.DATA.SHEET[,-5])
get_eigenvalue(PCA.DATA)
fviz_eig(PCA.DATA, addlabels=T, ylim = c(0,40))
get_eigenvalue(PCA.DATA.NOSENT)
fviz_eig(PCA.DATA.NOSENT, addlabels=T, ylim = c(0,40))
DATA.var<-get_pca_var(PCA.DATA)
DATA.var<-get_pca_var(PCA.DATA)
DATA.var
DATA.var<-get_pca_var(PCA.DATA)
DATA.NOSENT.var<-get_pca_var(PCA.DATA.NOSENT)
fviz_contrib(PCA.DATA, choice="var", axes = 1, top = 12.5)
fviz_contrib(PCA.DATA, choice="var", axes = 2, top = 12.5)
fviz_contrib(PCA.DATA, choice="var", axes = 3, top = 12.5)
fviz_contrib(PCA.DATA, choice="var", axes = 4, top = 12.5)
fviz_contrib(PCA.DATA.NOSENT, choice="var", axes = 1, top = 14.29)
fviz_contrib(PCA.DATA.NOSENT, choice="var", axes = 2, top = 14.29)
fviz_contrib(PCA.DATA.NOSENT, choice="var", axes = 3, top = 14.29)
get_eigenvalue(PCA.DATA.NOSENT)
fviz_eig(PCA.DATA.NOSENT, addlabels=T, ylim = c(0,40))
fviz_contrib(PCA.DATA.NOSENT, choice="var", axes = 4, top = 14.29)
PCA.DATA.SHEET<-DATA[,c(5,7,10,14,16,18,22,24,39)]
head(PCA.DATA.SHEET)
str(PCA.DATA.SHEET)
PCA.DATA.SHEET<-DATA[,c(5,7,10,14,16,18,22,24,25,39)]
head(PCA.DATA.SHEET)
str(PCA.DATA.SHEET)
PCA.DATA.SHEET<-DATA[,c(5,7,10,14,16,18,22,23,24,39)]
head(PCA.DATA.SHEET)
str(PCA.DATA.SHEET)
PCA.DATA<-PCA(PCA.DATA.SHEET[,-8])
PCA.DATA.NOSENT<-PCA(PCA.DATA.SHEET[,c(-5,-8)])
fviz_pca_biplot(PCA.DATA
,geom.ind = "point"
, repel = T
, col.ind=PCA.DATA.SHEET$BEHAVIOR
, addEllipses = T
, label = "var"
, palette=cbPalette
, col.var="black"
, legend.title = "Behavior")
fviz_pca_biplot(PCA.DATA
, axes = c(1,4)
, geom.ind = "point"
, repel = T
, col.ind=PCA.DATA.SHEET$BEHAVIOR
, addEllipses = T
, label = "var"
, palette=cbPalette
, col.var="black"
, legend.title = "Behavior")
fviz_pca_biplot(PCA.DATA
, axes = c(2,3)
, geom.ind = "point"
, repel = T
, col.ind=PCA.DATA.SHEET$BEHAVIOR
, addEllipses = T
, label = "var"
, palette=cbPalette
, col.var="black"
, legend.title = "Behavior")
PCA.DATA.SHEET<-DATA[,c(5,7,10,14,16,18,22,23,24,39)]
head(PCA.DATA.SHEET)
str(PCA.DATA.SHEET)
PCA.DATA.SHEET<-DATA[,c(5,7,10,14,16,18,22,23,24,39)]
head(PCA.DATA.SHEET)
str(PCA.DATA.SHEET)
PCA.DATA<-PCA(PCA.DATA.SHEET[,c(-7,-8)])
PCA.DATA<-PCA(PCA.DATA.SHEET[,c(-8,-9)])
PCA.DATA.NOSENT<-PCA(PCA.DATA.SHEET[,c(-5,-8,-9)])
get_eigenvalue(PCA.DATA)
fviz_eig(PCA.DATA, addlabels=T, ylim = c(0,40))
get_eigenvalue(PCA.DATA.NOSENT)
fviz_eig(PCA.DATA.NOSENT, addlabels=T, ylim = c(0,40))
DATA.var<-get_pca_var(PCA.DATA)
DATA.NOSENT.var<-get_pca_var(PCA.DATA.NOSENT)
fviz_contrib(PCA.DATA, choice="var", axes = 1, top = 12.5)
fviz_contrib(PCA.DATA, choice="var", axes = 2, top = 12.5)
fviz_contrib(PCA.DATA, choice="var", axes = 3, top = 12.5)
fviz_contrib(PCA.DATA, choice="var", axes = 4, top = 12.5)
fviz_contrib(PCA.DATA.NOSENT, choice="var", axes = 1, top = 14.29)
fviz_contrib(PCA.DATA.NOSENT, choice="var", axes = 2, top = 14.29)
fviz_contrib(PCA.DATA.NOSENT, choice="var", axes = 3, top = 14.29)
fviz_contrib(PCA.DATA.NOSENT, choice="var", axes = 4, top = 14.29)
fviz_pca_biplot(PCA.DATA
,geom.ind = "point"
, repel = T
, col.ind=PCA.DATA.SHEET$BEHAVIOR
, addEllipses = T
, label = "var"
, palette=cbPalette
, col.var="black"
, legend.title = "Behavior")
fviz_pca_biplot(PCA.DATA
, axes = c(1,4)
, geom.ind = "point"
, repel = T
, col.ind=PCA.DATA.SHEET$BEHAVIOR
, addEllipses = T
, label = "var"
, palette=cbPalette
, col.var="black"
, legend.title = "Behavior")
fviz_pca_biplot(PCA.DATA
, axes = c(1,4)
, geom.ind = "point"
, repel = T
, col.ind=PCA.DATA.SHEET$BEHAVIOR
, addEllipses = T
, label = "var"
, palette=cbPalette
, col.var="black"
, legend.title = "Behavior")
fviz_pca_biplot(PCA.DATA
, axes = c(2,3)
, geom.ind = "point"
, repel = T
, col.ind=PCA.DATA.SHEET$BEHAVIOR
, addEllipses = T
, label = "var"
, palette=cbPalette
, col.var="black"
, legend.title = "Behavior")
fviz_pca_biplot(PCA.DATA
, axes = c(2,3)
, geom.ind = "point"
, repel = T
, col.ind=PCA.DATA.SHEET$BEHAVIOR
, addEllipses = T
, label = "var"
, palette=cbPalette
, col.var="black"
, legend.title = "Behavior")
str(DATA)
DATA<-read.csv("DATA.csv", stringsAsFactors = T)
DATA$ID<-as.factor(DATA$ID)
DATA$ASIN_PROPORTION<-asin(sqrt(DATA$BEHAVIOR_PROPORTION))
str(DATA)
Simple.Prop <-lmer(ASIN_PROPORTION~BEHAVIOR+SENTINEL_PRESENCE+GENERALIZED_ENVIRONMENT+BAIT_PRESENCE+GROUP_SIZE+TOTAL_FREQUENCY_OF_DISTURBANCES+(1|ID)+(1|JULIAN_DATE)+(1|DECiMAL_TIME)+(1|TEMPERATURE), data = DATA)
Simple.Prop <-lmer(ASIN_PROPORTION~BEHAVIOR+SENTINEL_PRESENCE+GENERALIZED_ENVIRONMENT+BAIT_PRESENCE+GROUP_SIZE+TOTAL_FREQUENCY_OF_DISTURBANCES+(1|ID)+(1|JULIAN_DATE)+(1|DECIMAL_TIME)+(1|TEMPERATURE), data = DATA)
plot(Simple.Prop)
drop1(Simple.Prop, test="Chisq")
anova(Simple.Prop)
anova(Simple.Prop)
ranova(Simple.Prop)
drop1(Simple.Prop, test="Chisq")
Simple.Prop <-lmer(ASIN_PROPORTION~BEHAVIOR+SENTINEL_PRESENCE+GENERALIZED_ENVIRONMENT+BAIT_PRESENCE+GROUP_SIZE+TOTAL_FREQUENCY_OF_DISTURBANCES+(1|ID)+(1|JULIAN_DATE)+(1|DECIMAL_TIME)+(1|TEMPERATURE), data = DATA)
plot(Simple.Prop)
Simple.Prop <-rlmer(ASIN_PROPORTION~BEHAVIOR+SENTINEL_PRESENCE+GENERALIZED_ENVIRONMENT+BAIT_PRESENCE+GROUP_SIZE+TOTAL_FREQUENCY_OF_DISTURBANCES+(1|ID)+(1|JULIAN_DATE)+(1|DECIMAL_TIME)+(1|TEMPERATURE), data = DATA)
plot(Simple.Prop)
Simple.Prop <-lmer(ASIN_PROPORTION~BEHAVIOR+SENTINEL_PRESENCE+GENERALIZED_ENVIRONMENT+BAIT_PRESENCE+GROUP_SIZE+TOTAL_FREQUENCY_OF_DISTURBANCES+(1|ID)+(1|JULIAN_DATE)+(1|DECIMAL_TIME)+(1|TEMPERATURE), data = DATA)
plot(Simple.Prop)
anova(Simple.Prop)
ranova(Simple.Prop)
drop1(Simple.Prop, test="Chisq")
str(DATA)
MeanProp<-summarySE(DATA, "BEHAVIOR_PROPORTION", groupvars = c("GENERALIZED_ENVIRONMENT", "BEHAVIOR", "SENTINEL_PRESENCE"))
MeanProp
Anova(Simple.Prop)
ranova(Simple.Prop)
Simpler.Prop1 <-lmer(ASIN_PROPORTION~BEHAVIOR+SENTINEL_PRESENCE+GENERALIZED_ENVIRONMENT+BAIT_PRESENCE+GROUP_SIZE+(1|ID), data = DATA)
Simpler.Prop2 <-lmer(ASIN_PROPORTION~BEHAVIOR+SENTINEL_PRESENCE+GENERALIZED_ENVIRONMENT+BAIT_PRESENCE+(1|ID), data = DATA)
Simpler.Prop3 <-lmer(ASIN_PROPORTION~BEHAVIOR+SENTINEL_PRESENCE+GENERALIZED_ENVIRONMENT+(1|ID), data = DATA)
Simpler.Prop4 <-lmer(ASIN_PROPORTION~BEHAVIOR+SENTINEL_PRESENCE+(1|ID), data = DATA)
Simpler.Prop5 <-lmer(ASIN_PROPORTION~BEHAVIOR+(1|ID), data = DATA)
anova(Simpler.Prop1,Simpler.Prop2,Simpler.Prop3,Simpler.Prop4,Simpler.Prop5)
Anova(Simpler.Prop5)
DATA$LPek<-log(DATA$PECK_RATE)
Untransformed.PPM<-hist(DATA$PECK_RATE, na.rm=T, breaks = 12)
Transformed.PPM<-hist(DATA$LPek, breaks = 12)
op <- par(mfrow = c(1,2))
plot(Untransformed.PPM, main="Untransformed", ylab="Frequency", xlab="Pecks per minute")
plot(Transformed.PPM, main="Transformed", ylab="", xlab="Log(Pecks per minute)")
par(op)
### Summarize
MeanPeck<-summarySE(DATA, "PECK_RATE", c("GENERALIZED_ENVIRONMENT", "SENTINEL_PRESENCE"))
MeanPeck
### Summarize
MeanPeck<-summarySE(DATA, "PECK_RATE", c("GENERALIZED_ENVIRONMENT", "SENTINEL_PRESENCE"), na.rm=T)
MeanPeck
PeckPlot<-ggplot(MeanPeck, aes(x = GENERALIZED_ENVIRONMENT, y = PECK_RATE, colour = SENTINEL_PRESENCE)+
geom_point(position = position_dodge(width = 0.9)
, size = 3)+
geom_text(aes(label = signif(PECK_RATE))
, size = 3
, position=position_dodge2(width=1, preserve='single')
, hjust = -0.5
, vjust = 0.1)+
geom_errorbar(aes(ymin=(PECK_RATE-se), ymax=(PECK_RATE+se))
, width = 0.2
, position = position_dodge(.9))+
theme_bw()+
labs(colour = "Presence of a sentinel")+
ylab("Mean pecks per minute")+
scale_color_manual(values = cbPalette
, labels=c("Sentinel Absent", "Sentinel Present")) +
scale_x_discrete(labels=c("Commercial", "Green Area"))+
theme(legend.position = 'bottom'
, legend.title = element_blank()
, axis.title.x = element_blank()
, text=element_text(size = 12))
PeckPlot
PeckPlot<-ggplot(MeanPeck, aes(x = GENERALIZED_ENVIRONMENT, y = PECK_RATE, colour = SENTINEL_PRESENCE))+
geom_point(position = position_dodge(width = 0.9)
, size = 3)+
geom_text(aes(label = signif(PECK_RATE))
, size = 3
, position=position_dodge2(width=1, preserve='single')
, hjust = -0.5
, vjust = 0.1)+
geom_errorbar(aes(ymin=(PECK_RATE-se), ymax=(PECK_RATE+se))
, width = 0.2
, position = position_dodge(.9))+
theme_bw()+
labs(colour = "Presence of a sentinel")+
ylab("Mean pecks per minute")+
scale_color_manual(values = cbPalette
, labels=c("Sentinel Absent", "Sentinel Present")) +
scale_x_discrete(labels=c("Commercial", "Green Area"))+
theme(legend.position = 'bottom'
, legend.title = element_blank()
, axis.title.x = element_blank()
, text=element_text(size = 12))
PeckPlot
LMM.Peck<-lmer(LPek~SENTINEL_PRESENCE*GENERALIZED_ENVIRONMENT+BAIT_PRESENCE+(1|ID), data = DATA)
LMM.Peck<-lmer(LPek~SENTINEL_PRESENCE*GENERALIZED_ENVIRONMENT+BAIT_PRESENCE+(1|ID), data = DATA, na.rm=T)
LMM.Peck<-lmer(LPek~SENTINEL_PRESENCE*GENERALIZED_ENVIRONMENT+BAIT_PRESENCE+(1|ID), data = na.omit(DATA))
LMM.Peck<-lmer(LPek~SENTINEL_PRESENCE*GENERALIZED_ENVIRONMENT+BAIT_PRESENCE+(1|ID), data = DATA[complete.cases(df),])
LMM.Peck<-lmer(LPek~SENTINEL_PRESENCE*GENERALIZED_ENVIRONMENT+BAIT_PRESENCE+(1|ID), data = DATA[which(BEHAVIOR=="HD"),])
LMM.Peck<-lmer(LPek~SENTINEL_PRESENCE*GENERALIZED_ENVIRONMENT+BAIT_PRESENCE+(1|ID), data = DATA[which(DATA$BEHAVIOR=="HD"),])
LMM.Peck<-lmer(na.omit(LPek)~SENTINEL_PRESENCE*GENERALIZED_ENVIRONMENT+BAIT_PRESENCE+(1|ID), data = DATA)
DATA.PECK<-DATA[complete.cases(DATA),]
LMM.Peck<-lmer(LPek~SENTINEL_PRESENCE*GENERALIZED_ENVIRONMENT+BAIT_PRESENCE+(1|ID), data = DATA.PECK)
View(DATA.PECK)
DATA.PECK<-DATA[complete.cases(DATA),]
LMM.Peck<-lmer(LPek~SENTINEL_PRESENCE*GENERALIZED_ENVIRONMENT+BAIT_PRESENCE+(1|ID), data = DATA.PECK)
DATA$LPek<-log(DATA$PECK_RATE+1)
Untransformed.PPM<-hist(DATA$PECK_RATE, na.rm=T, breaks = 12)
Transformed.PPM<-hist(DATA$LPek, breaks = 12)
op <- par(mfrow = c(1,2))
plot(Untransformed.PPM, main="Untransformed", ylab="Frequency", xlab="Pecks per minute")
plot(Transformed.PPM, main="Transformed", ylab="", xlab="Log(Pecks per minute)")
par(op)
DATA$LPek<-log(DATA$PECK_RATE)
Untransformed.PPM<-hist(DATA$PECK_RATE, na.rm=T, breaks = 12)
Transformed.PPM<-hist(DATA$LPek, breaks = 12)
op <- par(mfrow = c(1,2))
plot(Untransformed.PPM, main="Untransformed", ylab="Frequency", xlab="Pecks per minute")
plot(Transformed.PPM, main="Transformed", ylab="", xlab="Log(Pecks per minute)")
par(op)
### Summarize
MeanPeck<-summarySE(DATA, "PECK_RATE", c("GENERALIZED_ENVIRONMENT", "SENTINEL_PRESENCE"), na.rm=T)
MeanPeck
PeckPlot<-ggplot(MeanPeck, aes(x = GENERALIZED_ENVIRONMENT, y = PECK_RATE, colour = SENTINEL_PRESENCE))+
geom_point(position = position_dodge(width = 0.9)
, size = 3)+
geom_text(aes(label = signif(PECK_RATE))
, size = 3
, position=position_dodge2(width=1, preserve='single')
, hjust = -0.5
, vjust = 0.1)+
geom_errorbar(aes(ymin=(PECK_RATE-se), ymax=(PECK_RATE+se))
, width = 0.2
, position = position_dodge(.9))+
theme_bw()+
labs(colour = "Presence of a sentinel")+
ylab("Mean pecks per minute")+
scale_color_manual(values = cbPalette
, labels=c("Sentinel Absent", "Sentinel Present")) +
scale_x_discrete(labels=c("Commercial", "Green Area"))+
theme(legend.position = 'bottom'
, legend.title = element_blank()
, axis.title.x = element_blank()
, text=element_text(size = 12))
PeckPlot
DATA.PECK<-DATA[complete.cases(DATA),]
LMM.Peck<-lmer(LPek~SENTINEL_PRESENCE*GENERALIZED_ENVIRONMENT+BAIT_PRESENCE+(1|ID), data = DATA.PECK)
DATA$LPek<-log(DATA$PECK_RATE)
DATA<-DATA[which(DATA$LPEK!="-Inf")]
View(DATA)
DATA<-read.csv("DATA.csv", stringsAsFactors = T)
DATA$ID<-as.factor(DATA$ID)
DATA$ASIN_PROPORTION<-asin(sqrt(DATA$BEHAVIOR_PROPORTION))
DATA$LPek<-log(DATA$PECK_RATE)
DATA<-DATA[which(DATA$LPEK!=-Inf)]
DATA<-read.csv("DATA.csv", stringsAsFactors = T)
DATA$ID<-as.factor(DATA$ID)
DATA$ASIN_PROPORTION<-asin(sqrt(DATA$BEHAVIOR_PROPORTION))
DATA$LPek<-log(DATA$PECK_RATE)
DATA<-DATA[which(DATA$LPEK!=-Inf),]
DATA<-read.csv("DATA.csv", stringsAsFactors = T)
DATA$ID<-as.factor(DATA$ID)
DATA$ASIN_PROPORTION<-asin(sqrt(DATA$BEHAVIOR_PROPORTION))
DATA$LPek<-log(DATA$PECK_RATE)
DATA<-DATA[which(DATA$LPEK!="-Inf"),]
DATA<-read.csv("DATA.csv", stringsAsFactors = T)
DATA$ID<-as.factor(DATA$ID)
DATA$ASIN_PROPORTION<-asin(sqrt(DATA$BEHAVIOR_PROPORTION))
DATA$LPek<-log(DATA$PECK_RATE)
DATA[~is.finite(DATA)]<-NA
DATA$LPek<-log(DATA$PECK_RATE)
DATA[~is.finite(DATA$LPek)]<-NA
DATA.PECK<-DATA[complete.cases(DATA),]
DATA.PECK<-DATA.PECK[DATA.PECK$BEHAVIOR_PROPORTION!=0,]
LMM.Peck<-lmer(LPek~SENTINEL_PRESENCE*GENERALIZED_ENVIRONMENT+BAIT_PRESENCE+(1|ID), data = DATA.PECK)
plot(LMM.Peck)
DATA.PECK<-DATA[complete.cases(DATA),]
DATA.PECK<-DATA.PECK[DATA.PECK$BEHAVIOR_PROPORTION!=0,]
LMM.Peck<-rlmer(LPek~SENTINEL_PRESENCE*GENERALIZED_ENVIRONMENT+BAIT_PRESENCE+(1|ID), data = DATA.PECK)
plot(LMM.Peck)
DATA.PECK<-DATA[complete.cases(DATA),]
DATA.PECK<-DATA.PECK[DATA.PECK$BEHAVIOR_PROPORTION!=0,]
LMM.Peck<-lmer(LPek~SENTINEL_PRESENCE*GENERALIZED_ENVIRONMENT+BAIT_PRESENCE+(1|ID), data = DATA.PECK)
plot(LMM.Peck)
Anova(LMM.Peck)
ranova(LMM.Peck)
sjPlot::tab_model(LMM.Peck
, show.re.var = T
, title = "Effects of generalized environment, bait, and the presence of a sentinel on the peck rate of foraging crows"
, dv.labels = " Effects on log of pecks per minute")
DATA.PECK<-DATA[complete.cases(DATA),]
DATA.PECK<-DATA.PECK[DATA.PECK$BEHAVIOR_PROPORTION!=0,]
LMM.Peck<-lmer(LPek~SENTINEL_PRESENCE*GENERALIZED_ENVIRONMENT+BAIT_PRESENCE+(1|ID), data = DATA.PECK)
plot(LMM.Peck)
Anova(LMM.Peck)
ranova(LMM.Peck)
sjPlot::tab_model(LMM.Peck
, show.re.var = T
, title = "Effects of generalized environment, bait, and the presence of a sentinel on the peck rate of foraging crows"
, dv.labels = " Effects on log of pecks per minute")
EnvPlot.PECK<- DATA.PECK %>%
summarySE(measurevar = "PECK_RATE"
, groupvars = "GENERALIZED_ENVIRONMENT") %>%
ggplot(aes(x = GENERALIZED_ENVIRONMENT, y = PECK_RATE))+
geom_point(position = position_dodge(width = 0.9)
, size = 3) +
geom_text(aes(label = signif(PECK_RATE))
, size = 3
, position=position_dodge2(width=0.9, preserve='single')
, hjust = -0.5
, vjust = 0.1)+
geom_errorbar(aes(ymin=(PECK_RATE-se), ymax=(PECK_RATE+se))
, width = 0.2
, position = position_dodge(width=.9))+
theme_bw()+
theme(text=element_text(size = 14))+
xlab("Generalized Environment")+
ylab("Peck Rate in Pecks per minute")+
theme(legend.position = 'bottom'
)
EnvPlot.PECK
BAITPlot.PECK<- DATA.PECK %>%
summarySE(measurevar = "PECK_RATE"
, groupvars = "BAIT_PRESENCE") %>%
ggplot(aes(x = BAIT_PRESENCE, y = PECK_RATE))+
geom_point(position = position_dodge(width = 0.9)
, size = 3) +
geom_text(aes(label = signif(PECK_RATE))
, size = 3
, position=position_dodge2(width=0.9, preserve='single')
, hjust = -0.5
, vjust = 0.1)+
geom_errorbar(aes(ymin=(PECK_RATE-se), ymax=(PECK_RATE+se))
, width = 0.2
, position = position_dodge(width=.9))+
theme_bw()+
theme(text=element_text(size = 14))+
xlab("Bait Presence")+
ylab("Peck Rate in Pecks per minute")+
theme(legend.position = 'bottom'
)
BAITPlot.PECK
RLMM.Dur.I<-rlmer(LDur~Behavior+Sentinel*CODED_NB_CROWS*Baited+G.Env+ (1|ID), data = Crow)
plot(RLMM.Dur.I)
head(PCA.Crow.Data)
Crow.eig.val<-get_eigenvalue(PCA.Crow)
Crow.eig.val
fviz_eig(PCA.Crow, addlabels=T, ylim = c(0,40))
fviz_contrib(PCA.Crow, choice="var", axes = 1, top = 20)
Crow.var
PCA.Crow
PCA.Crow$var
PCA.Crow$ind
print(PCA.Crow$ind)
PCA<-PCA.Crow$ind
View(PCA)
prcomp(PCA.Crow.Data[,-5])
?prcomp()
View(Crow)
PCA.Crow.Data<-Crow[,c(4,6,8,10,12:14)]
prcomp(PCA.Crow.Data)
prcomp(PCA.Crow.Data[,-5])
PCA.Crow.Data
str(PCA.Crow.Data)
prcomp(PCA.Crow.Data[,-5])
PCA.Crow.Data<-Crow[,c(4,6,8,10,12,14)]
str(PCA.Crow.Data)
PCA.Crow.Data<-Crow[,c(4,6,8,10,13,14)]
str(PCA.Crow.Data)
prcomp(PCA.Crow.Data)
PCA.Crow.Data$CODED_NB_CROWS<-as.numeric(PCA.Crow.Data$CODED_NB_CROWS)
prcomp(PCA.Crow.Data)
PCA<-prcomp(PCA.Crow.Data)
biplot(PCA)
biplot(PCA)
biplot(PCA)
PCA.Crow.Data<-Crow[,c(2.4,6,8,10,13)]
PCA.Crow.Data$CODED_NB_CROWS<-as.numeric(PCA.Crow.Data$CODED_NB_CROWS)
PCA<-prcomp(PCA.Crow.Data)
biplot(PCA)
DATA<-read.csv("DATA.csv", stringsAsFactors = T)
DATA$ID<-as.factor(DATA$ID)
DATA$ASIN_PROPORTION<-asin(sqrt(DATA$BEHAVIOR_PROPORTION))
DATA$CODED_BEHAVIOR<-rank(DATA$CODED_BEHAVIOR)
str(DATA)
DATA<-read.csv("DATA.csv", stringsAsFactors = T)
DATA$ID<-as.factor(DATA$ID)
DATA$ASIN_PROPORTION<-asin(sqrt(DATA$BEHAVIOR_PROPORTION))
DATA$CODED_BEHAVIOR<-as.ordered(DATA$CODED_BEHAVIOR)
str(DATA)
PCA.DATA.SHEET<-DATA[,c(5,7,10,14,16,18,22,23,24,39)]
head(PCA.DATA.SHEET)
str(PCA.DATA.SHEET)
PCA.DATA<-PCA(PCA.DATA.SHEET[,c(-8,-9)])
get_eigenvalue(PCA.DATA)
fviz_eig(PCA.DATA, addlabels=T, ylim = c(0,40))
prcomp(PCA.DATA.SHEET[,-8])
str(PCA.DATA.SHEET)
PeckPlot<-ggplot(MeanPeck, aes(x = GENERALIZED_ENVIRONMENT, y = PECK_RATE, colour = SENTINEL_PRESENCE))+
geom_point(position = position_dodge(width = 0.9)
, size = 3)+
geom_text(aes(label = signif(PECK_RATE))
, size = 3
, position=position_dodge2(width=1, preserve='single')
, hjust = -0.5
, vjust = 0.1)+
geom_errorbar(aes(ymin=(PECK_RATE-se), ymax=(PECK_RATE+se))
, width = 0.2
, position = position_dodge(.9))+
theme_bw()+
labs(colour = "Presence of a sentinel")+
ylab("Mean pecks per minute")+
scale_color_manual(values = cbPalette
, labels=c("Sentinel Absent", "Sentinel Present")) +
scale_x_discrete(labels=c("Commercial", "Green Area"))+
theme(legend.position = 'bottom'
, legend.title = element_blank()
, axis.title.x = element_blank()
, text=element_text(size = 12))+
facet_grid(~BAIT_PRESENCE)
PeckPlot
### Summarize
MeanPeck<-summarySE(DATA, "PECK_RATE", c("GENERALIZED_ENVIRONMENT", "SENTINEL_PRESENCE", "BAIT_PRESENCE"), na.rm=T)
MeanPeck
PeckPlot<-ggplot(MeanPeck, aes(x = GENERALIZED_ENVIRONMENT, y = PECK_RATE, colour = SENTINEL_PRESENCE))+
geom_point(position = position_dodge(width = 0.9)
, size = 3)+
geom_text(aes(label = signif(PECK_RATE))
, size = 3
, position=position_dodge2(width=1, preserve='single')
, hjust = -0.5
, vjust = 0.1)+
geom_errorbar(aes(ymin=(PECK_RATE-se), ymax=(PECK_RATE+se))
, width = 0.2
, position = position_dodge(.9))+
theme_bw()+
labs(colour = "Presence of a sentinel")+
ylab("Mean pecks per minute")+
scale_color_manual(values = cbPalette
, labels=c("Sentinel Absent", "Sentinel Present")) +
scale_x_discrete(labels=c("Commercial", "Green Area"))+
theme(legend.position = 'bottom'
, legend.title = element_blank()
, axis.title.x = element_blank()
, text=element_text(size = 12))+
facet_grid(~BAIT_PRESENCE)
PeckPlot
DATA$LPek<-log(DATA$PECK_RATE)
DATA.PECK<-DATA[complete.cases(DATA),]
DATA.PECK<-DATA.PECK[DATA.PECK$BEHAVIOR_PROPORTION!=0,]
### Summarize
MeanPeck<-summarySE(DATA.PECK, "PECK_RATE", c("GENERALIZED_ENVIRONMENT", "SENTINEL_PRESENCE", "BAIT_PRESENCE"))
MeanPeck
