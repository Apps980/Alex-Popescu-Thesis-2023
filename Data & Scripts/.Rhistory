BOUT.SUMMARY
summarySE(data = BOUT
, measurevar = "DURATION"
, groupvars = "BEHAVIOR"
) %>%
mutate(BEHAVIOR = recode_factor(BEHAVIOR
,'HD' = 'Foraging'#Rename HD as 'foraging'
, 'HU' = 'Alert') #Rename HU as 'Alert'
)
mean(BOUT$DURATION)
library("tidyverse")
library("tidyverse")
library("psych")
library("car")
library("ggplot2")
library("lmerTest")
library("robustlmm")
library("sjPlot")
library("effects")
library("doBy")
library("emmeans")
library("formattable")
library("dplyr")
library("descr")
library("MASS")
library("jmv")
library("webshot")
library("kableExtra")
source("./Calculate Summary Table with SE, SD, CI by grouping variables.R")
# The palette with black:
cbPalette <- c("#E69F00", "#56B4E9", "#CC79A7", "#009E73", "#F0E442", "#0072B2", "#D55E00")
labs.prop<-c(
'(Intercept)' = "Intercept"
, SENTINEL_PRESENCEYES = "Sentinel Presence"
, BEHAVIORHU = "Behavior"
, 'GENERALIZED_ENVIRONMENTGreen Area' = "Generalized Environment"
, GROUP_SIZESMALL = "Group Size"
, BAIT_PRESENCEYES = "Bait Presence"
, DISTURBANCE_FREQUENCY = "Disturbance Frequency"
)
labs.bout.1<-c(
'(Intercept)' = "Intercept"
, 'SENTINEL_PRESENCESentinel Absent' = "Sentinel Presence"
, BEHAVIORHU = "Behavior"
, 'GENERALIZED_ENVIRONMENTGreen Area' = "Generalized Environment"
, GROUP_SIZESMALL = "Group Size"
, BAIT_PRESENCEYES = "Bait Presence"
, DISTURBANCE_FREQUENCY = "Disturbance Frequency"
, 'BEHAVIORHU:GENERALIZED_ENVIRONMENTGreen Area' = "Behavior: Generalized Environment"
, 'BEHAVIORHU:SENTINEL_PRESENCESentinel Absent' = "Behavior: Sentinel Presence"
, 'SENTINEL_PRESENCESentinel Absent:GENERALIZED_ENVIRONMENTGreen Area' = "Sentinel Presence: Generalized Environment"
)
labs.bout.2<-c(
'(Intercept)' = "Intercept"
, 'SENTINEL_PRESENCESentinel Absent' = "Sentinel Presence"
, 'GENERALIZED_ENVIRONMENTGreen Area' = "Generalized Environment"
, GROUP_SIZESMALL = "Group Size"
, BAIT_PRESENCEYES = "Bait Presence"
, DISTURBANCE_FREQUENCY = "Disturbance Frequency"
,'SENTINEL_PRESENCESentinel Absent:GENERALIZED_ENVIRONMENTGreen Area' = "Sentinel Presence: Generalized Environment"
)
labs.peck<-c(
'(Intercept)' = "Intercept"
, SENTINEL_PRESENCEYES = "Sentinel Presence"
, 'GENERALIZED_ENVIRONMENTGreen Area' = "Generalized Environment"
, GROUP_SIZESMALL = "Group Size"
, BAIT_PRESENCEYES = "Bait Presence"
, DISTURBANCE_FREQUENCY = "Disturbance Frequency"
, 'GENERALIZED_ENVIRONMENTGreen Area:DISTURBANCE_FREQUENCY' = "Generalized Environment: Disturbance Frequency"
, 'SENTINEL_PRESENCEYES:GENERALIZED_ENVIRONMENTGreen Area' = "Sentinel Presence: Generalized Environment"
)
labs.ptwy<-c('(Intercept)' = "Intercept"
, 'SENTINEL_PRESENCESentinel Absent' = "Sentinel Presence"
, 'GENERALIZED_ENVIRONMENTGreen Area' = "Generalized Environment"
, BAIT_PRESENCEYES = "Bait Presence"
, DISTURBANCE_FREQUENCY = "Disturbance Frequency"
, 'SENTINEL_PRESENCESentinel Absent:GENERALIZED_ENVIRONMENTGreen Area' = "Sentinel Presence: Generalized Environment"
)
DATA.SR<-read.csv("DATA.SR.csv", stringsAsFactors = T) %>%
rename("VIDEO_ID" = "VIDEO_ID."
, "ID" = "ID.")
DATA.SR<-read.csv("DATA.SR.csv", stringsAsFactors = T) %>%
rename("VIDEO_ID" = "VIDEO_ID."
, "ID" = "ID.")
DATA.SR<-read.csv("DATA.SR.csv", stringsAsFactors = T) %>%
rename("ID" = "ID.")
DATA.SR<-read.csv("DATA.SR.csv", stringsAsFactors = T)
BOUT.raw<-read.csv("BOUT.csv", stringsAsFactors = T)
PROP<-DATA.SR[,c(1,2,15,17,19,22,30,36,41,46)] %>%
subset(.
, HU_BEHAVIOR_PROPORTION_... != 0
& HD_BEHAVIOR_PROPORTION_... != 0
) %>% #Remove cases where proportion = 1 or 0
rename("HU" = "HU_BEHAVIOR_PROPORTION_..."
, "HD" = "HD_BEHAVIOR_PROPORTION_..."
, "M" = "M_BEHAVIOR_PROPORTION_..."
, "DISTURBANCE_FREQUENCY" = "TOTAL_FREQUENCY_OF_DISTURBANCES"
) %>%
pivot_longer(., cols = c("HU"
, "HD"
, "M"
)
, names_to = "BEHAVIOR"
, values_to = "PROPORTION")
DATA.SR<-read.csv("DATA.SR.csv", stringsAsFactors = T)
BOUT.raw<-read.csv("BOUT.csv", stringsAsFactors = T)
View(DATA.SR)
DATA.SR<-read.csv("DATA.SR.csv", stringsAsFactors = T)
BOUT.raw<-read.csv("BOUT.csv", stringsAsFactors = T)
PROP<-DATA.SR[,c(1,2,15,17,19,22,30,36,41,46)] %>%
subset(.
, HU_BEHAVIOR_PROPORTION_... != 0
& HD_BEHAVIOR_PROPORTION_... != 0
) %>% #Remove cases where proportion = 1 or 0
rename("HU" = "HU_BEHAVIOR_PROPORTION_..."
, "HD" = "HD_BEHAVIOR_PROPORTION_..."
, "M" = "M_BEHAVIOR_PROPORTION_..."
, "DISTURBANCE_FREQUENCY" = "TOTAL_FREQUENCY_OF_DISTURBANCES"
) %>%
pivot_longer(., cols = c("HU"
, "HD"
, "M"
)
, names_to = "BEHAVIOR"
, values_to = "PROPORTION")
str(PROP)
View(DATA.SR)
DATA.SR<-read.csv("DATA.SR.csv", stringsAsFactors = T) %>%
rename("VIDEO_ID" = "VIDEO_ID."
, "ID" = "ID.")
BOUT.raw<-read.csv("BOUT.csv", stringsAsFactors = T)
PROP<-DATA.SR[,c(1,2,15,17,19,22,30,36,41,46)] %>%
subset(.
, HU_BEHAVIOR_PROPORTION_... != 0
& HD_BEHAVIOR_PROPORTION_... != 0
) %>% #Remove cases where proportion = 1 or 0
rename("HU" = "HU_BEHAVIOR_PROPORTION_..."
, "HD" = "HD_BEHAVIOR_PROPORTION_..."
, "M" = "M_BEHAVIOR_PROPORTION_..."
, "DISTURBANCE_FREQUENCY" = "TOTAL_FREQUENCY_OF_DISTURBANCES"
) %>%
pivot_longer(., cols = c("HU"
, "HD"
, "M"
)
, names_to = "BEHAVIOR"
, values_to = "PROPORTION")
str(PROP)
PROP.SUMMARY <- summarySE(data = PROP
, measurevar = "PROPORTION"
, groupvars = c("GENERALIZED_ENVIRONMENT"
, "BEHAVIOR"
, "SENTINEL_PRESENCE"
)
)
PROP.SUMMARY$SENTINEL_PRESENCE<-as.factor(replace(as.character(PROP.SUMMARY$SENTINEL_PRESENCE)
, PROP.SUMMARY$SENTINEL_PRESENCE=="NO"
, "Sentinel Absent"
)
)
PROP.SUMMARY$SENTINEL_PRESENCE<-as.factor(replace(as.character(PROP.SUMMARY$SENTINEL_PRESENCE)
, PROP.SUMMARY$SENTINEL_PRESENCE=="YES"
, "Sentinel Present"
)
)
PROP.SUMMARY
BOUT<-BOUT.raw %>%
filter(.
, DURATION > 0.01) %>% #Remove impossibly small values
filter(.
, BEHAVIOR != "M") %>% #Remove "M"
mutate(SENTINEL_PRESENCE = recode_factor(SENTINEL_PRESENCE
, 'YES' = "Sentinel Present"
, 'NO' = "Sentinel Absent"))
BOUT$LDURATION<-log(BOUT$DURATION) #Transform data for normality
str(BOUT)
BOUT.SUMMARY <- summarySE(data = BOUT
, measurevar = "DURATION"
, groupvars = c("GENERALIZED_ENVIRONMENT"
, "BEHAVIOR"
, "SENTINEL_PRESENCE"
)
) %>%
mutate(BEHAVIOR = recode_factor(BEHAVIOR
,'HD' = 'Foraging'#Rename HD as 'foraging'
, 'HU' = 'Alert') #Rename HU as 'Alert'
)
BOUT.SUMMARY
BOUT.DOTPLOT<-BOUT.SUMMARY %>%
ggplot(.
, aes(x = GENERALIZED_ENVIRONMENT
, y = DURATION
, colour = SENTINEL_PRESENCE))+
geom_point(position = position_dodge(width = 0.1)
, size = 3
) +
geom_errorbar(aes(ymin=(DURATION-se)
, ymax=(DURATION+se))
, width = 0.1
, position = position_dodge(width=0.1))+
geom_text(aes(label = round(DURATION, 2))
, hjust = -0.2
, size = 6
, show.legend = F
, family = "serif") +
theme_classic() +
ylab("Mean Bout Duration (s)") +
scale_colour_manual(values = cbPalette
, labels = c("Sentinel Absent", "Sentinel Present")
, name = "") +
scale_x_discrete(labels = c("Commercial", "Green"))+
theme(axis.title.x = element_blank()
, legend.position = "bottom"
, legend.box="vertical"
, legend.margin=margin()
, text = element_text(size = 18, family = "serif")
) +
facet_grid(~BEHAVIOR)
BOUT.DOTPLOT
BOUT.DOTPLOT<-BOUT.SUMMARY %>%
ggplot(.
, aes(x = GENERALIZED_ENVIRONMENT
, y = DURATION
, colour = SENTINEL_PRESENCE))+
geom_point(position = position_dodge(width = 0.1)
, size = 3
) +
geom_errorbar(aes(ymin=(DURATION-se)
, ymax=(DURATION+se))
, width = 0.1
, position = position_dodge(width=0.1))+
geom_text(aes(label = round(DURATION, 2))
, hjust = -0.2
, size = 6
, show.legend = F
, family = "serif") +
theme_classic() +
ylab("Mean Bout Duration (s)") +
scale_colour_manual(values = cbPalette
, name = "") +
scale_x_discrete(labels = c("Commercial", "Green"))+
theme(axis.title.x = element_blank()
, legend.position = "bottom"
, legend.box="vertical"
, legend.margin=margin()
, text = element_text(size = 18, family = "serif")
) +
facet_grid(~BEHAVIOR)
BOUT.DOTPLOT
BOUT.SUMMARY <- summarySE(data = BOUT
, measurevar = "DURATION"
, groupvars = c("GENERALIZED_ENVIRONMENT"
, "BEHAVIOR"
, "SENTINEL_PRESENCE"
)
) %>%
mutate(BEHAVIOR = recode_factor(BEHAVIOR
,'HD' = 'Foraging'#Rename HD as 'foraging'
, 'HU' = 'Alert') #Rename HU as 'Alert'
)
BOUT.SUMMARY
BOUT.MOD<-rlmer(LDURATION~BEHAVIOR*SENTINEL_PRESENCE+BEHAVIOR*GENERALIZED_ENVIRONMENT+SENTINEL_PRESENCE*GENERALIZED_ENVIRONMENT+GROUP_SIZE+BAIT_PRESENCE+DISTURBANCE_FREQUENCY+(1|ID), data = BOUT)
sjPlot::tab_model(BOUT.MOD
, pred.labels = labs.bout.1
, show.re.var = T
, show.se = T
, show.stat = T
, digits = 4
, title = ""
, dv.labels = "")
sjPlot::plot_model(BOUT.MOD
, axis.labels = labs.bout.1
, show.values=T
, show.p=T
, value.offset = 0.4
, value.size = 3.5
, wrap.title = 48
, show.re.var = T
, title = ""
) +
theme_sjplot(base_family = "serif" )
BOUT.DOTPLOT<-BOUT.SUMMARY %>%
ggplot(.
, aes(x = GENERALIZED_ENVIRONMENT
, y = DURATION
, colour = SENTINEL_PRESENCE))+
geom_point(position = position_dodge(width = 0.1)
, size = 3
) +
geom_errorbar(aes(ymin=(DURATION-se)
, ymax=(DURATION+se))
, width = 0.1
, position = position_dodge(width=0.1))+
geom_text(aes(label = round(DURATION, 2))
, hjust = -0.2
, size = 6
, show.legend = F
, family = "serif") +
theme_classic() +
ylab("Mean Bout Duration (s)") +
scale_colour_manual(values = cbPalette
, name = "") +
scale_x_discrete(labels = c("Commercial", "Green"))+
theme(axis.title.x = element_blank()
, legend.position = "bottom"
, legend.box="vertical"
, legend.margin=margin()
, text = element_text(size = 18, family = "serif")
) +
facet_grid(~BEHAVIOR)
BOUT.DOTPLOT
BOUT<-BOUT.raw %>%
filter(.
, DURATION > 0.01) %>% #Remove impossibly small values
filter(.
, BEHAVIOR != "M")
BOUT.SUMMARY <- summarySE(data = BOUT
, measurevar = "DURATION"
, groupvars = c("GENERALIZED_ENVIRONMENT"
, "BEHAVIOR"
, "SENTINEL_PRESENCE"
)
)
BOUT.SUMMARY
?geom_text
summarySE(data = BOUT
, measurevar = "DURATION"
, groupvars = "SENTINEL_PRESENCE"
)
sjPlot::tab_model(BOUT.MOD
, show.re.var = T
, show.se = T
, show.stat = T
, digits = 4
, title = ""
, dv.labels = "")
PTWY.SUMMARY<-PTWY %>%
rename("Foraging to Peck" = "NB_HD.HDP"
, "Alert to Foraging" = "NB_HU.HD"
, "Foraging to Alert" = "NB_HD.HU"
, "Peck to Alert" = "NB_HDP.HU"
) %>%
pivot_longer(., cols = c("Foraging to Peck"
, "Alert to Foraging"
, "Foraging to Alert"
, "Peck to Alert"
)
, names_to = "TRANSITION"
, values_to = "PTWY") %>%
summarySE(.
, measurevar = "PTWY"
, groupvars = c("TRANSITION"
, "SENTINEL_PRESENCE"
, "GENERALIZED_ENVIRONMENT"))
PTWY<- DATA.SR %>%
dplyr::select(VIDEO_ID,ID, DECIMAL_TIME, GENERALIZED_ENVIRONMENT, SENTINEL_PRESENCE, BAIT_PRESENCE, NUMBER_OF_CROWS_RECORDED, GROUP_SIZE, TOTAL_NB_TRANSITIONS, TOTAL_FREQUENCY_OF_DISTURBANCES | starts_with("NB_")) %>%
rename("DISTURBANCE_FREQUENCY" = "TOTAL_FREQUENCY_OF_DISTURBANCES"
, "Transitions" = "TOTAL_NB_TRANSITIONS") %>%
mutate(SENTINEL_PRESENCE = recode_factor(SENTINEL_PRESENCE
, 'YES' = "Sentinel Present"
, 'NO' = "Sentinel Absent"))
PTWY.SUMMARY<-PTWY %>%
rename("Foraging to Peck" = "NB_HD.HDP"
, "Alert to Foraging" = "NB_HU.HD"
, "Foraging to Alert" = "NB_HD.HU"
, "Peck to Alert" = "NB_HDP.HU"
) %>%
pivot_longer(., cols = c("Foraging to Peck"
, "Alert to Foraging"
, "Foraging to Alert"
, "Peck to Alert"
)
, names_to = "TRANSITION"
, values_to = "PTWY") %>%
summarySE(.
, measurevar = "PTWY"
, groupvars = c("TRANSITION"
, "SENTINEL_PRESENCE"
, "GENERALIZED_ENVIRONMENT"))
PTWY.BOXPLOT<-PTWY %>%
rename("Foraging to Peck" = "NB_HD.HDP"
, "Alert to Foraging" = "NB_HU.HD"
, "Foraging to Alert" = "NB_HD.HU"
, "Peck to Alert" = "NB_HDP.HU"
) %>%
pivot_longer(., cols = c("Foraging to Peck"
, "Alert to Foraging"
, "Foraging to Alert"
, "Peck to Alert"
)
, names_to = "TRANSITION"
, values_to = "PTWY") %>%
ggplot(.
, aes(x = GENERALIZED_ENVIRONMENT
, y = PTWY
, colour = SENTINEL_PRESENCE)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(aes(x = GENERALIZED_ENVIRONMENT
, group = SENTINEL_PRESENCE)
, position = position_jitterdodge(jitter.width = 0.5)
, alpha = 0.25
) +
geom_point(data = PTWY.SUMMARY
, aes( x = GENERALIZED_ENVIRONMENT
, y = PTWY
, group = SENTINEL_PRESENCE)
, size = 2
, colour = "black"
, position = position_dodge(width = 0.75)) +
geom_errorbar(data = PTWY.SUMMARY
, aes(ymin=(PTWY-se)
, ymax=(PTWY+se)
, group = SENTINEL_PRESENCE
, x = GENERALIZED_ENVIRONMENT)
, width = 0.2
, colour = "black"
, position = position_dodge(width=0.75
)) +
theme_classic() +
ylab("Number of Transitions") +
ylim(0,100)+
scale_colour_manual(values = cbPalette
, name = "") +
scale_x_discrete(labels = c("Commercial", "Green")
)+
theme(axis.title.x = element_blank()
, legend.position = "bottom"
, legend.box="vertical"
, legend.margin=margin()
, text = element_text(size = 14, family = "serif")
) +
facet_grid(~TRANSITION)
PTWY.BOXPLOT
PTWY<- DATA.SR %>%
dplyr::select(VIDEO_ID,ID, DECIMAL_TIME, GENERALIZED_ENVIRONMENT, SENTINEL_PRESENCE, BAIT_PRESENCE, NUMBER_OF_CROWS_RECORDED, GROUP_SIZE, TOTAL_NB_TRANSITIONS, TOTAL_FREQUENCY_OF_DISTURBANCES | starts_with("NB_")) %>%
rename("DISTURBANCE_FREQUENCY" = "TOTAL_FREQUENCY_OF_DISTURBANCES"
, "Transitions" = "TOTAL_NB_TRANSITIONS") %>%
mutate(SENTINEL_PRESENCE = recode_factor(SENTINEL_PRESENCE
, 'NO' = "Sentinel Absent"
, 'YES' = "Sentinel Present"))
PTWY.SUMMARY<-PTWY %>%
rename("Foraging to Peck" = "NB_HD.HDP"
, "Alert to Foraging" = "NB_HU.HD"
, "Foraging to Alert" = "NB_HD.HU"
, "Peck to Alert" = "NB_HDP.HU"
) %>%
pivot_longer(., cols = c("Foraging to Peck"
, "Alert to Foraging"
, "Foraging to Alert"
, "Peck to Alert"
)
, names_to = "TRANSITION"
, values_to = "PTWY") %>%
summarySE(.
, measurevar = "PTWY"
, groupvars = c("TRANSITION"
, "SENTINEL_PRESENCE"
, "GENERALIZED_ENVIRONMENT"))
PTWY.BOXPLOT<-PTWY %>%
rename("Foraging to Peck" = "NB_HD.HDP"
, "Alert to Foraging" = "NB_HU.HD"
, "Foraging to Alert" = "NB_HD.HU"
, "Peck to Alert" = "NB_HDP.HU"
) %>%
pivot_longer(., cols = c("Foraging to Peck"
, "Alert to Foraging"
, "Foraging to Alert"
, "Peck to Alert"
)
, names_to = "TRANSITION"
, values_to = "PTWY") %>%
ggplot(.
, aes(x = GENERALIZED_ENVIRONMENT
, y = PTWY
, colour = SENTINEL_PRESENCE)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(aes(x = GENERALIZED_ENVIRONMENT
, group = SENTINEL_PRESENCE)
, position = position_jitterdodge(jitter.width = 0.5)
, alpha = 0.25
) +
geom_point(data = PTWY.SUMMARY
, aes( x = GENERALIZED_ENVIRONMENT
, y = PTWY
, group = SENTINEL_PRESENCE)
, size = 2
, colour = "black"
, position = position_dodge(width = 0.75)) +
geom_errorbar(data = PTWY.SUMMARY
, aes(ymin=(PTWY-se)
, ymax=(PTWY+se)
, group = SENTINEL_PRESENCE
, x = GENERALIZED_ENVIRONMENT)
, width = 0.2
, colour = "black"
, position = position_dodge(width=0.75
)) +
theme_classic() +
ylab("Number of Transitions") +
ylim(0,100)+
scale_colour_manual(values = cbPalette
, name = "") +
scale_x_discrete(labels = c("Commercial", "Green")
)+
theme(axis.title.x = element_blank()
, legend.position = "bottom"
, legend.box="vertical"
, legend.margin=margin()
, text = element_text(size = 14, family = "serif")
) +
facet_grid(~TRANSITION)
PTWY.BOXPLOT
