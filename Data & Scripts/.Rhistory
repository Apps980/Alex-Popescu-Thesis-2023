) +
theme_classic() +
xlab("Group Size") +
ylab("Mean Foraging Bout Duration (s)") +
scale_color_manual(values = cbPalette) +
scale_x_discrete(labels = c("Small Group"
, "Large Group")
, limits = c("SMALL", "LARGE")) +
theme(axis.title.x = element_blank()
, legend.position = "none"
, legend.box="vertical"
, legend.margin=margin()
, text = element_text(size = 18, family = "serif")
)
BOUT.DOTPLOT.GROUP_SIZE
BOUT.DOTPLOT.BAIT<-BOUT %>%
filter(., BEHAVIOR == "HD") %>%
summarySE(., measurevar = "DURATION", groupvar = "BAIT_PRESENCE") %>%
ggplot(.
, aes(x = BAIT_PRESENCE
, y = DURATION
, colour = BAIT_PRESENCE
))+
geom_point(position = position_dodge(width = 0.1)
, size = 3
) +
geom_errorbar(aes(ymin=(DURATION-se)
, ymax=(DURATION+se))
, width = 0.1
, position = position_dodge(width=0.1))+
geom_text(aes(label = round(DURATION, 2))
, hjust = -0.2
, size = 6
, show.legend = F
, family = "serif") +
theme_classic() +
ylab("Mean Foraging Bout Duration (s)") +
scale_color_manual(values = cbPalette) +
scale_x_discrete(labels = c("Bait Absent"
, "Bait Present")) +
theme(axis.title.x = element_blank()
, legend.position = "none"
, legend.box="vertical"
, legend.margin=margin()
, text = element_text(size = 18, family = "serif")
)
BOUT.DOTPLOT.BAIT
BOUT.DOTPLOT.DISTURBANCES.HD<-BOUT %>%
filter(., BEHAVIOR == "HD") %>%
ggplot(.
, aes(x = DISTURBANCE_FREQUENCY
, y = DURATION
))+
geom_point(size = 2
, colour = cbPalette[1]
, alpha = 0.5
)+
geom_smooth(method = "lm"
, se = F
, colour = cbPalette [2]) +
theme_classic() +
xlab("Disturbance Frequency (per minute)") +
ylab("Foraging Bout Duration (s)") +
theme(legend.position = "none"
, text = element_text(size = 18, family = "serif")
)
BOUT.DOTPLOT.DISTURBANCES.HD
BOUT.MOD.HU<-rlmer(LDURATION~SENTINEL_PRESENCE*GENERALIZED_ENVIRONMENT+GROUP_SIZE+BAIT_PRESENCE+DISTURBANCE_FREQUENCY+(1|ID), data = subset(BOUT, BEHAVIOR == "HU"))
sjPlot::tab_model(BOUT.MOD.HU
, pred.labels = labs.bout.2
, show.re.var = T
, show.se = T
, show.stat = T
, digits = 4
, title = "Head Up"
, dv.labels = " Effects on alert bout duration")
sjPlot::plot_model(BOUT.MOD.HU
, axis.labels = labs.bout.2
, show.values=T
, show.p=T
, value.offset = 0.4
, value.size = 3.5
, wrap.title = 48
, show.re.var = T
, title = "Effects on alert bout duration") +
theme_sjplot(base_family = "serif")
sjPlot::tab_model(c(BOUT.MOD, BOUT.MOD.HD, BOUT.MOD.HU)
, pred.labels = labs.bout.1
, show.re.var = T
, show.se = T
, show.stat = T
, digits = 4
, order.terms = c(1,3,4,5,6,7,10,2,8,9)
, title = ""
, dv.labels = c("Bouts of all behaviors"
, "Bouts of foraging behavior"
, "Bouts of alert behavior")
, file = "Bout_Table.html"
)
webshot("Bout_Table.html", "Bout_Table.png")
PECK<-DATA.SR[,c(1,2,15,17,19,22,30,38,48)] %>%
subset(., HD_BEHAVIOR_DURATION > 0) %>%
rename("DISTURBANCE_FREQUENCY" = "TOTAL_FREQUENCY_OF_DISTURBANCES")
str(PECK)
PECK.SUMMARY<-summarySE(PECK, "PECK_RATE"
, c("GENERALIZED_ENVIRONMENT"
, "SENTINEL_PRESENCE")
, na.rm=T)
PECK.SUMMARY
PECK.DOTPLOT<-ggplot(data = PECK.SUMMARY
, aes(x = GENERALIZED_ENVIRONMENT
, y = PECK_RATE
, color = SENTINEL_PRESENCE))+
geom_point(position = position_dodge(width = 0.9)
, size = 3
) +
geom_errorbar(aes(ymin=(PECK_RATE-se)
, ymax=(PECK_RATE+se))
, width = 0.1
, position = position_dodge(width=0.9))+
geom_text(aes(label = scales::label_number(accuracy=0.01)(PECK_RATE))
, position = position_dodge(width = 0.4)
, size = 6
, show.legend = F
, family = "serif"
) +
theme_classic() +
ylab("Mean Peck Rate (per min)") +
scale_colour_manual(values = cbPalette
, labels = c("Sentinel Absent", "Sentinel Present")
, name = "")+
scale_x_discrete(labels = c("Commercial"
, "Green")) +
theme(axis.title.x = element_blank()
, legend.position = "bottom"
, legend.box="vertical"
, legend.margin=margin()
, text = element_text(size = 18, family = "serif"))
PECK.DOTPLOT
PECK.MOD<-rlmer(PECK_RATE~SENTINEL_PRESENCE*GENERALIZED_ENVIRONMENT+GENERALIZED_ENVIRONMENT*DISTURBANCE_FREQUENCY+GROUP_SIZE+BAIT_PRESENCE+(1|ID), data = PECK)
sjPlot::tab_model(PECK.MOD
, pred.labels = labs.peck
, show.re.var = T
, show.se = T
, show.stat = T
, digits = 4
, title = ""
, dv.labels = ""
, file = "Peck_Table.html")
sjPlot::plot_model(PECK.MOD
, axis.labels = labs.peck
, show.values=T
, show.p=T
, value.offset = 0.4
, value.size = 3.5
, wrap.title = 48
, show.re.var = T
, title = "" ) +
theme_sjplot(base_family = "serif")
webshot("Peck_Table.html", "Peck_Table.png")
PECK.DOTPLOT.DISTURBANCE<-PECK %>%
ggplot(aes(x = DISTURBANCE_FREQUENCY
, y = PECK_RATE
, color = GENERALIZED_ENVIRONMENT))+
geom_point(size = 3) +
geom_smooth(method = "lm", se = F) +
theme_classic() +
labs(y="Peck Rate (per min)", x="Disturbance Frequency (per min)")+
scale_x_continuous(n.breaks=14)+
theme(legend.position = "bottom"
, text = element_text(size = 18, family = "serif"))+
scale_color_manual(values = cbPalette
, labels = c("Commercial Area"
, "Green Area")
, name="")
PECK.DOTPLOT.DISTURBANCE
PECK.DOTPLOT.BAIT<-PECK %>%
summarySE(.
, measurevar = "PECK_RATE"
, groupvars = "BAIT_PRESENCE") %>%
ggplot(.
, aes(x = BAIT_PRESENCE
, y = PECK_RATE
, colour = BAIT_PRESENCE
))+
geom_point(position = position_dodge(width = 0.1)
, size = 3
) +
geom_errorbar(aes(ymin=(PECK_RATE-se)
, ymax=(PECK_RATE+se))
, width = 0.1
, position = position_dodge(width=0.1))+
geom_text(aes(label = round(PECK_RATE, 2))
, hjust = -0.2
, size = 6
, show.legend = F
, family = "serif") +
theme_classic() +
ylab("Mean Peck Rate (per min)") +
scale_x_discrete(labels = c("Baited Absent"
, "Bait Present")) +
scale_color_manual(values = cbPalette) +
theme(axis.title.x = element_blank()
, legend.position = "none"
, legend.box="vertical"
, legend.margin=margin()
, text = element_text(size = 18, family = "serif"))
PECK.DOTPLOT.BAIT
SENT<-DATA.SR[1:81,c(1,7,10,15,17,19,20,22,30,31)] %>%
distinct()
str(SENT)
SENT.SUMMARY <- summarySE(data = SENT
, measurevar = "GROUP_SIZE" #Random
, groupvars = c("GENERALIZED_ENVIRONMENT"
, "SENTINEL_PRESENCE"
)
)
SENT.SUMMARY
SENT.BARPLOT <- ggplot(SENT.SUMMARY, aes(x=GENERALIZED_ENVIRONMENT
, fill = SENTINEL_PRESENCE
, y = N
, group = SENTINEL_PRESENCE)) +
geom_bar(stat='identity', width=.5, position = "dodge") +
geom_text(aes(label = N, group = SENTINEL_PRESENCE)
, position = position_dodge(width = 0.5)
, vjust = 1.5
, size = 8
, family = "serif") +
ylab("Number of observations") +
theme_classic() +
scale_fill_manual(""
, values = cbPalette
, labels = c("Sentinel Absent", "Sentinel Present")
) +
scale_x_discrete(labels = c("Commercial"
, "Green")) +
theme(axis.title.x = element_blank()
, text = element_text(size = 18, family = "serif")
, legend.position = "bottom"
, legend.box="vertical"
, legend.margin=margin())
SENT.BARPLOT
SENT.CHISQ<-lapply(SENT[,c("GENERALIZED_ENVIRONMENT"
, "GROUP_SIZE"
, "DISTURBANCE_FREQUENCY"
)
]
, function(x) CrossTable(x,SENT$SENTINEL_PRESENCE
, fisher = T
, chisq = T
, expected = T
, prop.c = F
, prop.t = F
, prop.chisq = F
, sresid = T
, format = 'SPSS'
)
)
SENT.CHISQ
SENT.FREQ <- SENT %>%
rename("Temperature (deg. C)" = "TEMPERATURE"
, "Decimal Time" = "DECIMAL_TIME"
, "Disturbance Frequency (per min)" = "TOTAL_FREQUENCY_OF_DISTURBANCES"
, "Number of Crows" = "NUMBER_OF_CROWS_RECORDED") %>%
pivot_longer(., cols = c(#"Temperature (deg. C)"
# , "Decimal Time"
"Number of Crows"
, "Disturbance Frequency (per min)")
, names_to = "Var"
, values_to = "Val") %>%
ggplot(aes(
x = Val
, colour = SENTINEL_PRESENCE))+
geom_freqpoly(linewidth = 1
, alpha=I(.6)) +
scale_colour_manual(values = cbPalette
, name = ""
, labels = c("Sentinel Absent"
, "Sentinel Present")) +
facet_wrap(~Var, scale = "free_x") +
theme_classic() +
theme(legend.position = "bottom"
, axis.title.x = element_blank()
, text = element_text(size = 18, family = "serif"))
SENT.FREQ
PTWY<- DATA.SR %>%
dplyr::select(VIDEO_ID,ID, DECIMAL_TIME, GENERALIZED_ENVIRONMENT, SENTINEL_PRESENCE, BAIT_PRESENCE, NUMBER_OF_CROWS_RECORDED, GROUP_SIZE, TOTAL_NB_TRANSITIONS, TOTAL_FREQUENCY_OF_DISTURBANCES | starts_with("NB_")) %>%
rename("DISTURBANCE_FREQUENCY" = "TOTAL_FREQUENCY_OF_DISTURBANCES"
, "Transitions" = "TOTAL_NB_TRANSITIONS") %>%
mutate(SENTINEL_PRESENCE = recode_factor(SENTINEL_PRESENCE
, 'NO' = "Sentinel Absent"
, 'YES' = "Sentinel Present"))
PTWY.SUMMARY<-PTWY %>%
rename("Foraging to Peck" = "NB_HD.HDP"
, "Alert to Foraging" = "NB_HU.HD"
, "Foraging to Alert" = "NB_HD.HU"
, "Peck to Alert" = "NB_HDP.HU"
) %>%
pivot_longer(., cols = c("Foraging to Peck"
, "Alert to Foraging"
, "Foraging to Alert"
, "Peck to Alert"
)
, names_to = "TRANSITION"
, values_to = "PTWY") %>%
summarySE(.
, measurevar = "PTWY"
, groupvars = c("TRANSITION"
, "SENTINEL_PRESENCE"
, "GENERALIZED_ENVIRONMENT"))
PTWY.BOXPLOT<-PTWY %>%
rename("Foraging to Peck" = "NB_HD.HDP"
, "Alert to Foraging" = "NB_HU.HD"
, "Foraging to Alert" = "NB_HD.HU"
, "Peck to Alert" = "NB_HDP.HU"
) %>%
pivot_longer(., cols = c("Foraging to Peck"
, "Alert to Foraging"
, "Foraging to Alert"
, "Peck to Alert"
)
, names_to = "TRANSITION"
, values_to = "PTWY") %>%
ggplot(.
, aes(x = GENERALIZED_ENVIRONMENT
, y = PTWY
, colour = SENTINEL_PRESENCE)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(aes(x = GENERALIZED_ENVIRONMENT
, group = SENTINEL_PRESENCE)
, position = position_jitterdodge(jitter.width = 0.5)
, alpha = 0.25
) +
geom_point(data = PTWY.SUMMARY
, aes( x = GENERALIZED_ENVIRONMENT
, y = PTWY
, group = SENTINEL_PRESENCE)
, size = 2
, colour = "black"
, position = position_dodge(width = 0.75)) +
geom_errorbar(data = PTWY.SUMMARY
, aes(ymin=(PTWY-se)
, ymax=(PTWY+se)
, group = SENTINEL_PRESENCE
, x = GENERALIZED_ENVIRONMENT)
, width = 0.2
, colour = "black"
, position = position_dodge(width=0.75
)) +
theme_classic() +
ylab("Number of Transitions") +
ylim(0,100)+
scale_colour_manual(values = cbPalette
, name = "") +
scale_x_discrete(labels = c("Commercial", "Green")
)+
theme(axis.title.x = element_blank()
, legend.position = "bottom"
, legend.box="vertical"
, legend.margin=margin()
, text = element_text(size = 14, family = "serif")
) +
facet_grid(~TRANSITION)
PTWY.BOXPLOT
PTWY.MODELS<-list()
DV<-list("NB_HD.HU"
, "NB_HD.HDP"
, "NB_HU.HD"
, "NB_HDP.HU"
)
for (y in DV){
formula<-formula(paste(y,"~SENTINEL_PRESENCE*GENERALIZED_ENVIRONMENT+DISTURBANCE_FREQUENCY+BAIT_PRESENCE+(1|Transitions)"))
PTWY.MODELS[[y]]<-glmer(formula, data = PTWY, family = "poisson", control=glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=100000)))
}
tab_model(PTWY.MODELS
, pred.labels = labs.ptwy
, show.re.var = T
, show.se = T
, show.stat = T
, digits = 4
, title = ""
, dv.labels = c("Foraging to Alert"
, "Foraging to Peck"
, "Alert to Foraging"
, "Peck to Alert")
)
webshot("PTWY_Table.html", "PTWY_Table.png")
PTWY.MODELS<-list()
DV<-list("NB_HD.HU"
, "NB_HD.HDP"
, "NB_HU.HD"
, "NB_HDP.HU"
)
for (y in DV){
formula<-formula(paste(y,"~SENTINEL_PRESENCE*GENERALIZED_ENVIRONMENT+DISTURBANCE_FREQUENCY+BAIT_PRESENCE+(1|Transitions)"))
PTWY.MODELS[[y]]<-glmer(formula, data = PTWY, family = "poisson", control=glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=100000)))
}
tab_model(PTWY.MODELS
, pred.labels = labs.ptwy
, show.re.var = T
, show.se = T
, show.stat = T
, digits = 4
, title = ""
, dv.labels = c("Foraging to Alert"
, "Foraging to Peck"
, "Alert to Foraging"
, "Peck to Alert")
, file = "PTWY_Table.html"
)
webshot("PTWY_Table.html", "PTWY_Table.png")
PROP.SUMMARY <- summarySE(data = PROP
, measurevar = "PROPORTION"
, groupvars = c("GENERALIZED_ENVIRONMENT"
)
)
library("tidyverse")
library("psych")
library("car")
library("ggplot2")
library("lmerTest")
library("robustlmm")
library("sjPlot")
library("effects")
library("doBy")
library("emmeans")
library("formattable")
library("dplyr")
library("descr")
library("MASS")
library("jmv")
library("webshot")
library("kableExtra")
source("./Calculate Summary Table with SE, SD, CI by grouping variables.R")
# The palette with black:
cbPalette <- c("#E69F00", "#56B4E9", "#CC79A7", "#009E73", "#F0E442", "#0072B2", "#D55E00")
labs.prop<-c(
'(Intercept)' = "Intercept"
, SENTINEL_PRESENCEYES = "Sentinel Presence"
, BEHAVIORHU = "Behaviour"
, 'GENERALIZED_ENVIRONMENTGreen Area' = "Generalized Environment"
, GROUP_SIZESMALL = "Group Size"
, BAIT_PRESENCEYES = "Bait Presence"
, DISTURBANCE_FREQUENCY = "Disturbance Frequency"
)
labs.bout.1<-c(
'(Intercept)' = "Intercept"
, 'SENTINEL_PRESENCESentinel Present' = "Sentinel Presence"
, BEHAVIORHU = "Behaviour"
, 'GENERALIZED_ENVIRONMENTGreen Area' = "Generalized Environment"
, GROUP_SIZESMALL = "Group Size"
, BAIT_PRESENCEYES = "Bait Presence"
, DISTURBANCE_FREQUENCY = "Disturbance Frequency"
, 'BEHAVIORHU:GENERALIZED_ENVIRONMENTGreen Area' = "Behaviour: Generalized Environment"
, 'BEHAVIORHU:SENTINEL_PRESENCESentinel Present' = "Behaviour: Sentinel Presence"
, 'SENTINEL_PRESENCESentinel Present:GENERALIZED_ENVIRONMENTGreen Area' = "Sentinel Presence: Generalized Environment"
)
labs.bout.2<-c(
'(Intercept)' = "Intercept"
, 'SENTINEL_PRESENCESentinel Present' = "Sentinel Presence"
, 'GENERALIZED_ENVIRONMENTGreen Area' = "Generalized Environment"
, GROUP_SIZESMALL = "Group Size"
, BAIT_PRESENCEYES = "Bait Presence"
, DISTURBANCE_FREQUENCY = "Disturbance Frequency"
,'SENTINEL_PRESENCESentinel Present:GENERALIZED_ENVIRONMENTGreen Area' = "Sentinel Presence: Generalized Environment"
)
labs.peck<-c(
'(Intercept)' = "Intercept"
, SENTINEL_PRESENCEYES = "Sentinel Presence"
, 'GENERALIZED_ENVIRONMENTGreen Area' = "Generalized Environment"
, GROUP_SIZESMALL = "Group Size"
, BAIT_PRESENCEYES = "Bait Presence"
, DISTURBANCE_FREQUENCY = "Disturbance Frequency"
, 'GENERALIZED_ENVIRONMENTGreen Area:DISTURBANCE_FREQUENCY' = "Generalized Environment: Disturbance Frequency"
, 'SENTINEL_PRESENCEYES:GENERALIZED_ENVIRONMENTGreen Area' = "Sentinel Presence: Generalized Environment"
)
labs.ptwy<-c('(Intercept)' = "Intercept"
, 'SENTINEL_PRESENCESentinel Present' = "Sentinel Presence"
, 'GENERALIZED_ENVIRONMENTGreen Area' = "Generalized Environment"
, BAIT_PRESENCEYES = "Bait Presence"
, DISTURBANCE_FREQUENCY = "Disturbance Frequency"
, 'SENTINEL_PRESENCESentinel Present:GENERALIZED_ENVIRONMENTGreen Area' = "Sentinel Presence: Generalized Environment"
)
DATA.SR<-read.csv("DATA.SR.csv", stringsAsFactors = T) %>%
rename("VIDEO_ID" = "VIDEO_ID."
, "ID" = "ID.")
BOUT.raw<-read.csv("BOUT.csv", stringsAsFactors = T)
PROP<-DATA.SR[,c(1,2,15,17,19,22,30,36,41,46)] %>%
subset(.
, HU_BEHAVIOR_PROPORTION_... != 0
& HD_BEHAVIOR_PROPORTION_... != 0
) %>% #Remove cases where proportion = 1 or 0
rename("HU" = "HU_BEHAVIOR_PROPORTION_..."
, "HD" = "HD_BEHAVIOR_PROPORTION_..."
, "M" = "M_BEHAVIOR_PROPORTION_..."
, "DISTURBANCE_FREQUENCY" = "TOTAL_FREQUENCY_OF_DISTURBANCES"
) %>%
pivot_longer(., cols = c("HU"
, "HD"
, "M"
)
, names_to = "BEHAVIOR"
, values_to = "PROPORTION")
str(PROP)
PROP.SUMMARY <- summarySE(data = PROP
, measurevar = "PROPORTION"
, groupvars = c("GENERALIZED_ENVIRONMENT"
)
)
)
PROP.SUMMARY
135/3
