, pred.labels = labs.ptwy
, show.re.var = T
, show.se = T
, show.stat = T
, digits = 4
, title = ""
, dv.labels = c("Foraging to Alert"
, "Foraging to Peck"
, "Alert to Foraging"
, "Peck to Alert")
, file = "PTWY_Table.html")
View(tab)
tab[["page.complete"]]
tab$page.complete <- gsub("TOTAL_NB_TRANSITIONS" = "Number of transitions"
, tab$page.complete)
?gsub
tab<-tab_model(PTWY.MODELS
, pred.labels = labs.ptwy
, show.re.var = T
, show.se = T
, show.stat = T
, digits = 4
, title = ""
, dv.labels = c("Foraging to Alert"
, "Foraging to Peck"
, "Alert to Foraging"
, "Peck to Alert")
)
tab$page.complete <- gsub("TOTAL_NB_TRANSITIONS" = "Number of transitions"
, tab$page.complete)
tab$page.complete <- gsub("TOTAL_NB_TRANSITIONS" = "Number of transitions"
, tab$page.complete)
tab$page.complete <- gsub('TOTAL_NB_TRANSITIONS' = 'Number of transitions'
, tab$page.complete)
tab$page.complete <- gsub('TOTAL_NB_TRANSITIONS' = 'Number of transitions', tab$page.complete)
PTWY<- DATA.SR %>%
dplyr::select(VIDEO_ID,ID, DECIMAL_TIME, GENERALIZED_ENVIRONMENT, SENTINEL_PRESENCE, BAIT_PRESENCE, NUMBER_OF_CROWS_RECORDED, GROUP_SIZE, TOTAL_NB_TRANSITIONS, TOTAL_FREQUENCY_OF_DISTURBANCES | starts_with("NB_")) %>%
rename("DISTURBANCE_FREQUENCY" = "TOTAL_FREQUENCY_OF_DISTURBANCES"
, "Transitions" = "TOTAL_NB_TRANSITIONS") %>%
mutate(SENTINEL_PRESENCE = recode_factor(SENTINEL_PRESENCE
, 'YES' = "Sentinel Present"
, 'NO' = "Sentinel Absent"))
library("tidyverse")
library("psych")
library("car")
library("ggplot2")
library("lmerTest")
library("robustlmm")
library("sjPlot")
library("effects")
library("doBy")
library("emmeans")
library("formattable")
library("dplyr")
library("descr")
library("MASS")
library("jmv")
library("webshot")
library("kableExtra")
source("./Calculate Summary Table with SE, SD, CI by grouping variables.R")
PTWY<- DATA.SR %>%
dplyr::select(VIDEO_ID,ID, DECIMAL_TIME, GENERALIZED_ENVIRONMENT, SENTINEL_PRESENCE, BAIT_PRESENCE, NUMBER_OF_CROWS_RECORDED, GROUP_SIZE, TOTAL_NB_TRANSITIONS, TOTAL_FREQUENCY_OF_DISTURBANCES | starts_with("NB_")) %>%
rename("DISTURBANCE_FREQUENCY" = "TOTAL_FREQUENCY_OF_DISTURBANCES"
, "Transitions" = "TOTAL_NB_TRANSITIONS") %>%
mutate(SENTINEL_PRESENCE = recode_factor(SENTINEL_PRESENCE
, 'YES' = "Sentinel Present"
, 'NO' = "Sentinel Absent"))
PTWY.MODELS<-list()
DV<-list("NB_HD.HU"
, "NB_HD.HDP"
, "NB_HU.HD"
, "NB_HDP.HU"
)
for (y in DV){
formula<-formula(paste(y,"~SENTINEL_PRESENCE*GENERALIZED_ENVIRONMENT+DISTURBANCE_FREQUENCY+BAIT_PRESENCE+(1|Transitions)"))
PTWY.MODELS[[y]]<-glmer(formula, data = PTWY, family = "poisson", control=glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=100000)))
}
tab<-tab_model(PTWY.MODELS
, pred.labels = labs.ptwy
, show.re.var = T
, show.se = T
, show.stat = T
, digits = 4
, title = ""
, dv.labels = c("Foraging to Alert"
, "Foraging to Peck"
, "Alert to Foraging"
, "Peck to Alert")
)
PTWY.MODELS<-list()
DV<-list("NB_HD.HU"
, "NB_HD.HDP"
, "NB_HU.HD"
, "NB_HDP.HU"
)
for (y in DV){
formula<-formula(paste(y,"~SENTINEL_PRESENCE*GENERALIZED_ENVIRONMENT+DISTURBANCE_FREQUENCY+BAIT_PRESENCE+(1|Transitions)"))
PTWY.MODELS[[y]]<-glmer(formula, data = PTWY, family = "poisson", control=glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=100000)))
}
tab<-tab_model(PTWY.MODELS
, pred.labels = labs.ptwy
, show.re.var = T
, show.se = T
, show.stat = T
, digits = 4
, title = ""
, dv.labels = c("Foraging to Alert"
, "Foraging to Peck"
, "Alert to Foraging"
, "Peck to Alert")
, file = "PTWY_Table.html"
)
PTWY.MODELS<-list()
DV<-list("NB_HD.HU"
, "NB_HD.HDP"
, "NB_HU.HD"
, "NB_HDP.HU"
)
for (y in DV){
formula<-formula(paste(y,"~SENTINEL_PRESENCE*GENERALIZED_ENVIRONMENT+DISTURBANCE_FREQUENCY+BAIT_PRESENCE+(1|Transitions)"))
PTWY.MODELS[[y]]<-glmer(formula, data = PTWY, family = "poisson", control=glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=100000)))
}
tab_model(PTWY.MODELS
, pred.labels = labs.ptwy
, show.re.var = T
, show.se = T
, show.stat = T
, digits = 4
, title = ""
, dv.labels = c("Foraging to Alert"
, "Foraging to Peck"
, "Alert to Foraging"
, "Peck to Alert")
, file = "PTWY_Table.html"
)
webshot("PTWY_Table.html", "PTWY_Table.png")
?print()
?print
PTWY.MODELS<-list()
DV<-list("NB_HD.HU"
, "NB_HD.HDP"
, "NB_HU.HD"
, "NB_HDP.HU"
)
for (y in DV){
formula<-formula(paste(y,"~SENTINEL_PRESENCE*GENERALIZED_ENVIRONMENT+DISTURBANCE_FREQUENCY+BAIT_PRESENCE+(1|Transitions)"))
PTWY.MODELS[[y]]<-glmer(formula, data = PTWY, family = "poisson", control=glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=100000)))
}
tab_model(PTWY.MODELS
, pred.labels = labs.ptwy
, show.re.var = T
, show.se = T
, show.stat = T
, digits = 4
, title = ""
, dv.labels = c("Foraging to Alert"
, "Foraging to Peck"
, "Alert to Foraging"
, "Peck to Alert")
)+
theme_sjplot(base_family = "serif")
webshot("PTWY_Table.html", "PTWY_Table.png")
sjPlot::tab_model(c(BOUT.MOD, BOUT.MOD.HD, BOUT.MOD.HU)
, pred.labels = labs.bout.1
, show.re.var = T
, show.se = T
, show.stat = T
, digits = 4
, title = c("A", "B", "C")
, dv.labels = "")+
theme_sjplot(base_family = "serif")
sjPlot::plot_model(c(BOUT.MOD, BOUT.MOD.HD, BOUT.MOD.HU)
, pred.labels = labs.bout.1
, show.re.var = T
, show.se = T
, show.stat = T
, digits = 4
, title = c("A", "B", "C")
, dv.labels = "")+
theme_sjplot(base_family = "serif")
sjPlot::plot_model(c(BOUT.MOD, BOUT.MOD.HD, BOUT.MOD.HU)
, axis.labels = labs.bout.1
, show.values=T
, show.p=T
, value.offset = 0.4
, value.size = 3.5
, wrap.title = 48
, show.re.var = T
, title = ""
, dv.labels = c("A", "B", "C")
) +
theme_sjplot(base_family = "serif" )
sjPlot::plot_model(c(BOUT.MOD, BOUT.MOD.HD, BOUT.MOD.HU)
, axis.labels = labs.bout.1
, show.values=T
, show.p=T
, value.offset = 0.4
, value.size = 3.5
, wrap.title = 48
, show.re.var = T
, title = ""
) +
theme_sjplot(base_family = "serif" )
sjPlot::plot_model(c(BOUT.MOD.HD, BOUT.MOD.HU)
, axis.labels = labs.bout.2
, show.values=T
, show.p=T
, value.offset = 0.4
, value.size = 3.5
, wrap.title = 48
, show.re.var = T
, title = ""
) +
theme_sjplot(base_family = "serif" )
sjPlot::plot_model(c(BOUT.MOD.HD)
, axis.labels = labs.bout.2
, show.values=T
, show.p=T
, value.offset = 0.4
, value.size = 3.5
, wrap.title = 48
, show.re.var = T
, title = ""
) +
theme_sjplot(base_family = "serif" )
BOUT.MOD<-rlmer(LDURATION~BEHAVIOR*SENTINEL_PRESENCE+BEHAVIOR*GENERALIZED_ENVIRONMENT+SENTINEL_PRESENCE*GENERALIZED_ENVIRONMENT+GROUP_SIZE+BAIT_PRESENCE+DISTURBANCE_FREQUENCY+(1|ID), data = BOUT)
sjPlot::tab_model(BOUT.MOD
, pred.labels = labs.bout.1
, show.re.var = T
, show.se = T
, show.stat = T
, digits = 4
, title = "Bout Robust Model  Output"
, dv.labels = " Effects on duration of bouts of all behaviors")+
theme_sjplot(base_family = "serif")
sjPlot::plot_model(BOUT.MOD
, axis.labels = labs.bout.1
, show.values=T
, show.p=T
, value.offset = 0.4
, value.size = 3.5
, wrap.title = 48
, show.re.var = T
, title = "Effects on duration of bouts of all behaviors"
) +
theme_sjplot(base_family = "serif" )
sjPlot::plot_model(c(BOUT.MOD, BOUT.MOD.HD, BOUT.MOD.HU)
, axis.labels = labs.bout.1
, show.values=T
, show.p=T
, value.offset = 0.4
, value.size = 3.5
, wrap.title = 48
, show.re.var = T
, title = ""
) +
theme_sjplot(base_family = "serif" )
sjPlot::plot_model(BOUT.MOD.HU
, axis.labels = labs.bout.1
, show.values=T
, show.p=T
, value.offset = 0.4
, value.size = 3.5
, wrap.title = 48
, show.re.var = T
, title = ""
) +
theme_sjplot(base_family = "serif" )
sjPlot::plot_models(BOUT.MOD.HU, BOUT.MOD.HD
, axis.labels = labs.bout.1
, show.values=T
, show.p=T
, value.offset = 0.4
, value.size = 3.5
, wrap.title = 48
, show.re.var = T
, title = ""
) +
theme_sjplot(base_family = "serif" )
sjPlot::plot_model(BOUT.MOD.HU, BOUT.MOD.HD
, axis.labels = labs.bout.1
, show.values=T
, show.p=T
, value.offset = 0.4
, value.size = 3.5
, wrap.title = 48
, show.re.var = T
, title = ""
) +
theme_sjplot(base_family = "serif" )
PROP.MOD<-lm(PROPORTION~BEHAVIOR+SENTINEL_PRESENCE+GENERALIZED_ENVIRONMENT, data = subset(PROP, PROP$BEHAVIOR != "M"))
sjPlot::tab_model(PROP.MOD
, pred.labels = labs.prop
, show.stat = T
, show.se = T
, digits = 4
, show.re.var = T
, title = ""
, dv.labels = ""
, file = "Proportion_Table.html")+
theme_sjplot(base_family = "serif")
webshot("Proportion_Table.html", "Proportion_Table.png")
webshot("Proportion_Table.html", "Proportion_Table.png")
PROP.MOD<-lm(PROPORTION~BEHAVIOR+SENTINEL_PRESENCE+GENERALIZED_ENVIRONMENT, data = subset(PROP, PROP$BEHAVIOR != "M"))
sjPlot::tab_model(PROP.MOD
, pred.labels = labs.prop
, show.stat = T
, show.se = T
, digits = 4
, show.re.var = T
, title = ""
, dv.labels = ""
, file = "Proportion_Table.html")
PROP.MOD<-lm(PROPORTION~BEHAVIOR+SENTINEL_PRESENCE+GENERALIZED_ENVIRONMENT, data = subset(PROP, PROP$BEHAVIOR != "M"))
sjPlot::tab_model(PROP.MOD
, pred.labels = labs.prop
, show.stat = T
, show.se = T
, digits = 4
, show.re.var = T
, title = ""
, dv.labels = ""
, family = "serif"
, file = "Proportion_Table.html")
PROP.MOD<-lm(PROPORTION~BEHAVIOR+SENTINEL_PRESENCE+GENERALIZED_ENVIRONMENT, data = subset(PROP, PROP$BEHAVIOR != "M"))
sjPlot::tab_model(PROP.MOD
, pred.labels = labs.prop
, show.stat = T
, show.se = T
, digits = 4
, show.re.var = T
, title = ""
, dv.labels = ""
, file = "Proportion_Table.html")
webshot("Proportion_Table.html", "Proportion_Table.png")
BOUT.MOD<-rlmer(LDURATION~BEHAVIOR*SENTINEL_PRESENCE+BEHAVIOR*GENERALIZED_ENVIRONMENT+SENTINEL_PRESENCE*GENERALIZED_ENVIRONMENT+GROUP_SIZE+BAIT_PRESENCE+DISTURBANCE_FREQUENCY+(1|ID), data = BOUT)
sjPlot::tab_model(BOUT.MOD
, pred.labels = labs.bout.1
, show.re.var = T
, show.se = T
, show.stat = T
, digits = 4
, title = "Bout Robust Model  Output"
, dv.labels = " Effects on duration of bouts of all behaviors")
sjPlot::plot_model(BOUT.MOD
, axis.labels = labs.bout.1
, show.values=T
, show.p=T
, value.offset = 0.4
, value.size = 3.5
, wrap.title = 48
, show.re.var = T
, title = "Effects on duration of bouts of all behaviors"
) +
theme_sjplot(base_family = "serif" )
BOUT.DOTPLOT.DISTURBANCES<-BOUT %>%
ggplot(.
, aes(x = DISTURBANCE_FREQUENCY
, y = DURATION
))+
geom_point(size = 2
, colour = cbPalette[1]
, alpha = 0.5
)+
geom_smooth(method = "lm"
, se = F
, colour = cbPalette [2]) +
theme_classic() +
xlab("Disturbance Frequency (per minute)") +
ylab("Bout Duration (s)") +
theme(legend.position = "none"
, text = element_text(size = 18, family = "serif")
)
BOUT.DOTPLOT.DISTURBANCES
BOUT.MOD.HD<-rlmer(LDURATION~SENTINEL_PRESENCE*GENERALIZED_ENVIRONMENT+GROUP_SIZE+BAIT_PRESENCE+DISTURBANCE_FREQUENCY+(1|ID), data = subset(BOUT, BEHAVIOR == "HD"))
sjPlot::tab_model(BOUT.MOD.HD
, pred.labels = labs.bout.2
, show.re.var = T
, show.se = T
, show.stat = T
, digits = 4
, title = ""
, dv.labels = "")
sjPlot::plot_model(BOUT.MOD.HD
, axis.labels = labs.bout.2
, show.values=T
, show.p=T
, value.offset = 0.4
, value.size = 3.5
, wrap.title = 48
, show.re.var = T
, title = "") +
theme_sjplot(base_family = "serif")
PECK.MOD<-rlmer(PECK_RATE~SENTINEL_PRESENCE*GENERALIZED_ENVIRONMENT+GENERALIZED_ENVIRONMENT*DISTURBANCE_FREQUENCY+GROUP_SIZE+BAIT_PRESENCE+(1|ID), data = PECK)
sjPlot::tab_model(PECK.MOD
, pred.labels = labs.peck
, show.re.var = T
, show.se = T
, show.stat = T
, digits = 4
, title = ""
, dv.labels = ""
, file = "Peck_Table.html")
sjPlot::plot_model(PECK.MOD
, axis.labels = labs.peck
, show.values=T
, show.p=T
, value.offset = 0.4
, value.size = 3.5
, wrap.title = 48
, show.re.var = T
, title = "" ) +
theme_sjplot(base_family = "serif")
webshot("Peck_Table.html", "Peck_Table.png")
DATA.SR<-read.csv("DATA.SR.csv", stringsAsFactors = T) %>%
rename("VIDEO_ID" = "VIDEO_ID."
, "ID" = "ID.")
library("tidyverse")
library("psych")
library("car")
library("ggplot2")
library("lmerTest")
library("robustlmm")
library("sjPlot")
library("effects")
library("doBy")
library("emmeans")
library("formattable")
library("dplyr")
library("descr")
library("MASS")
library("jmv")
library("webshot")
library("kableExtra")
source("./Calculate Summary Table with SE, SD, CI by grouping variables.R")
DATA.SR<-read.csv("DATA.SR.csv", stringsAsFactors = T) %>%
rename("VIDEO_ID" = "VIDEO_ID."
, "ID" = "ID.")
BOUT.raw<-read.csv("BOUT.csv", stringsAsFactors = T)
summarize(DATA.SR$GENERALIZED_ENVIRONMENT)
summarise(DATA.SR$GENERALIZED_ENVIRONMENT)
summarize(SENT)
SENT<-DATA.SR[1:81,c(1,7,10,15,17,19,20,22,30,31)] %>%
distinct()
str(SENT)
str(SENT)
SENT.SUMMARY <- summarySE(data = SENT
, measurevar = "GROUP_SIZE" #Random
, groupvars = c("GENERALIZED_ENVIRONMENT"
, "SENTINEL_PRESENCE"
)
)
SENT.SUMMARY
summarySE(data = SENT
, measurevar = "GROUP_SIZE" #Random
, groupvars = c("GENERALIZED_ENVIRONMENT")
)
SENT
duplicated(SENT$VIDEO_ID)
duplicated(SENT$VIDEO_ID)
count(duplicated(SENT$VIDEO_ID))
tally(duplicated(SENT$VIDEO_ID))
sum(duplicated(SENT$VIDEO_ID))
summarySE(data = SENT
+                       , measurevar = "GROUP_SIZE" #Random
summarySE(data = SENT
+                       , measurevar = "GROUP_SIZE" #Random
summarySE(data = SENT, measurevar = "GROUP_SIZE" #Random
+                       , groupvars = "SENTINEL_PRESENCE"
sum(duplicated(DATA.SR$ID))
BOUT.SUMMARY <- summarySE(data = BOUT
, measurevar = "DURATION"
, groupvars = c("GENERALIZED_ENVIRONMENT"
, "BEHAVIOR"
, "SENTINEL_PRESENCE"
)
) %>%
mutate(BEHAVIOR = recode_factor(BEHAVIOR
,'HD' = 'Foraging'#Rename HD as 'foraging'
, 'HU' = 'Alert') #Rename HU as 'Alert'
)
BOUT<-BOUT.raw %>%
filter(.
, DURATION > 0.01) %>% #Remove impossibly small values
filter(.
, BEHAVIOR != "M") %>% #Remove "M"
mutate(SENTINEL_PRESENCE = recode_factor(SENTINEL_PRESENCE
, 'YES' = "Sentinel Present"
, 'NO' = "Sentinel Absent"))
BOUT$LDURATION<-log(BOUT$DURATION) #Transform data for normality
str(BOUT)
BOUT.SUMMARY <- summarySE(data = BOUT
, measurevar = "DURATION"
, groupvars = c("GENERALIZED_ENVIRONMENT"
, "BEHAVIOR"
, "SENTINEL_PRESENCE"
)
) %>%
mutate(BEHAVIOR = recode_factor(BEHAVIOR
,'HD' = 'Foraging'#Rename HD as 'foraging'
, 'HU' = 'Alert') #Rename HU as 'Alert'
)
BOUT.SUMMARY
summarySE(data = BOUT
, measurevar = "DURATION"
, groupvars = "BEHAVIOR"
) %>%
mutate(BEHAVIOR = recode_factor(BEHAVIOR
,'HD' = 'Foraging'#Rename HD as 'foraging'
, 'HU' = 'Alert') #Rename HU as 'Alert'
)
mean(BOUT$DURATION)
