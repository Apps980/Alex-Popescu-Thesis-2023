) %>%
pivot_longer(., cols = c("HU"
, "HD"
, "M")
, names_to = "BEHAVIOR"
, values_to = "PROPORTION")
PROP$ASIN_PROPORTION<-asin(sqrt(PROP$PROPORTION)) #Transform for normality
str(PROP)
PROP.SUMMARY <- summarySE(data = PROP
, measurevar = "PROPORTION"
, groupvars = c("GENERALIZED_ENVIRONMENT"
, "BEHAVIOR"
)
)
PROP.SUMMARY
PROP.BARPLOT<-ggplot(PROP.SUMMARY
, aes(x = GENERALIZED_ENVIRONMENT
, y = PROPORTION
, fill = BEHAVIOR))+
geom_bar(stat = 'identity'
, position = 'stack')+
geom_text(aes(label = paste0(formattable::digits(PROPORTION*100, dig=2)
, "%"))
, position = position_stack(vjust = 0.5)
, size = 4) +
scale_y_continuous(labels = scales::percent) +
theme_classic()+
ylab("Proportion of time")+
scale_x_discrete(labels=c("Commercial Area"
, "Green Area"))+
scale_fill_manual(values = cbPalette, labels = c("Foraging"
, "Alert"
, "Moving")
, name="")+
theme(legend.position = "bottom"
, text = element_text(size = 18)
, axis.title.x = element_blank())
PROP.BARPLOT
SENT<-DATA.SR[1:81,c(1,7,10,15,17,19,20,22,30,31)] %>%
distinct()
str(SENT)
SENT.BARPLOT <- ggplot(SENT.SUMMARY, aes(x=GENERALIZED_ENVIRONMENT
, fill = SENTINEL_PRESENCE
, y = N
, group = SENTINEL_PRESENCE)) +
geom_bar(stat='identity', width=.5, position = "dodge") +
geom_text(aes(label = N, group = SENTINEL_PRESENCE), position = position_dodge(width = 0.5), vjust = 1.5, size = 8) +
ylab("Number of observations") +
theme_classic() +
scale_fill_manual(""
, values = cbPalette
, labels = c("Sentinel Absent", "Sentinel Present")
) +
theme(axis.title.x = element_blank()
, text = element_text(size = 18)
, legend.position = "bottom"
, legend.box="vertical"
, legend.margin=margin())
SENT.SUMMARY <- summarySE(data = SENT
, measurevar = "GROUP_SIZE" #Random
, groupvars = c("GENERALIZED_ENVIRONMENT"
, "SENTINEL_PRESENCE"
)
)
SENT.SUMMARY
SENT.BARPLOT <- ggplot(SENT.SUMMARY, aes(x=GENERALIZED_ENVIRONMENT
, fill = SENTINEL_PRESENCE
, y = N
, group = SENTINEL_PRESENCE)) +
geom_bar(stat='identity', width=.5, position = "dodge") +
geom_text(aes(label = N, group = SENTINEL_PRESENCE), position = position_dodge(width = 0.5), vjust = 1.5, size = 8) +
ylab("Number of observations") +
theme_classic() +
scale_fill_manual(""
, values = cbPalette
, labels = c("Sentinel Absent", "Sentinel Present")
) +
theme(axis.title.x = element_blank()
, text = element_text(size = 18)
, legend.position = "bottom"
, legend.box="vertical"
, legend.margin=margin())
SENT.BARPLOT
PECK.DOTPLOT<-ggplot(data = PECK.SUMMARY
, aes(x = GENERALIZED_ENVIRONMENT
, y = PECK_RATE
, color = GENERALIZED_ENVIRONMENT))+
geom_point(position = position_dodge(width = 0.9)
, size = 3) +
geom_errorbar(aes(ymin=(PECK_RATE-se)
, ymax=(PECK_RATE+se))
, width = 0.1
, position = position_dodge(width=0.9))+
geom_text(aes(label = PECK_RATE), size = 4)
PECK<-DATA.SR[,c(1,2,15,17,19,22,30,38,48)] %>%
subset(., HD_BEHAVIOR_DURATION > 0) %>%
rename("DISTURBANCE_FREQUENCY" = "TOTAL_FREQUENCY_OF_DISTURBANCES")
str(PECK)
PECK.SUMMARY<-summarySE(PECK, "PECK_RATE"
, "GENERALIZED_ENVIRONMENT"
, na.rm=T)
PECK.SUMMARY
PECK.DOTPLOT<-ggplot(data = PECK.SUMMARY
, aes(x = GENERALIZED_ENVIRONMENT
, y = PECK_RATE
, color = GENERALIZED_ENVIRONMENT))+
geom_point(position = position_dodge(width = 0.9)
, size = 3) +
geom_errorbar(aes(ymin=(PECK_RATE-se)
, ymax=(PECK_RATE+se))
, width = 0.1
, position = position_dodge(width=0.9))+
geom_text(aes(label = PECK_RATE), size = 4)
theme_classic() +
ylab("Mean Peck Rate (per min)") +
scale_colour_manual(values = cbPalette
, guide="none") +
scale_x_discrete(labels = c("Commercial Area"
, "Green Area")) +
theme(axis.title.x = element_blank()
, legend.position = "bottom"
, legend.box="vertical"
, legend.margin=margin()
, text = element_text(size = 18))
PECK.DOTPLOT<-ggplot(data = PECK.SUMMARY
, aes(x = GENERALIZED_ENVIRONMENT
, y = PECK_RATE
, color = GENERALIZED_ENVIRONMENT))+
geom_point(position = position_dodge(width = 0.9)
, size = 3) +
geom_errorbar(aes(ymin=(PECK_RATE-se)
, ymax=(PECK_RATE+se))
, width = 0.1
, position = position_dodge(width=0.9))+
geom_text(aes(label = PECK_RATE), size = 4) +
theme_classic() +
ylab("Mean Peck Rate (per min)") +
scale_colour_manual(values = cbPalette
, guide="none") +
scale_x_discrete(labels = c("Commercial Area"
, "Green Area")) +
theme(axis.title.x = element_blank()
, legend.position = "bottom"
, legend.box="vertical"
, legend.margin=margin()
, text = element_text(size = 18))
PECK.DOTPLOT
PECK.DOTPLOT<-ggplot(data = PECK.SUMMARY
, aes(x = GENERALIZED_ENVIRONMENT
, y = PECK_RATE
, color = GENERALIZED_ENVIRONMENT))+
geom_point(position = position_dodge(width = 0.9)
, size = 3) +
geom_errorbar(aes(ymin=(PECK_RATE-se)
, ymax=(PECK_RATE+se))
, width = 0.1
, position = position_dodge(width=0.9))+
geom_text(aes(label = PECK_RATE), position = position_dodge(width = 1), size = 4) +
theme_classic() +
ylab("Mean Peck Rate (per min)") +
scale_colour_manual(values = cbPalette
, guide="none") +
scale_x_discrete(labels = c("Commercial Area"
, "Green Area")) +
theme(axis.title.x = element_blank()
, legend.position = "bottom"
, legend.box="vertical"
, legend.margin=margin()
, text = element_text(size = 18))
PECK.DOTPLOT
PECK.DOTPLOT<-ggplot(data = PECK.SUMMARY
, aes(x = GENERALIZED_ENVIRONMENT
, y = PECK_RATE
, color = GENERALIZED_ENVIRONMENT))+
geom_point(position = position_dodge(width = 0.9)
, size = 3) +
geom_errorbar(aes(ymin=(PECK_RATE-se)
, ymax=(PECK_RATE+se))
, width = 0.1
, position = position_dodge(width=0.9))+
geom_text(aes(label = PECK_RATE), position = position_dodge(width = -1), size = 4) +
theme_classic() +
ylab("Mean Peck Rate (per min)") +
scale_colour_manual(values = cbPalette
, guide="none") +
scale_x_discrete(labels = c("Commercial Area"
, "Green Area")) +
theme(axis.title.x = element_blank()
, legend.position = "bottom"
, legend.box="vertical"
, legend.margin=margin()
, text = element_text(size = 18))
PECK.DOTPLOT
PECK.DOTPLOT<-ggplot(data = PECK.SUMMARY
, aes(x = GENERALIZED_ENVIRONMENT
, y = PECK_RATE
, color = GENERALIZED_ENVIRONMENT))+
geom_point(position = position_dodge(width = 0.9)
, size = 3) +
geom_errorbar(aes(ymin=(PECK_RATE-se)
, ymax=(PECK_RATE+se))
, width = 0.1
, position = position_dodge(width=0.9))+
geom_text(aes(label = PECK_RATE), hjust = -1, size = 4) +
theme_classic() +
ylab("Mean Peck Rate (per min)") +
scale_colour_manual(values = cbPalette
, guide="none") +
scale_x_discrete(labels = c("Commercial Area"
, "Green Area")) +
theme(axis.title.x = element_blank()
, legend.position = "bottom"
, legend.box="vertical"
, legend.margin=margin()
, text = element_text(size = 18))
PECK.DOTPLOT
PECK.DOTPLOT<-ggplot(data = PECK.SUMMARY
, aes(x = GENERALIZED_ENVIRONMENT
, y = PECK_RATE
, color = GENERALIZED_ENVIRONMENT))+
geom_point(position = position_dodge(width = 0.9)
, size = 3) +
geom_errorbar(aes(ymin=(PECK_RATE-se)
, ymax=(PECK_RATE+se))
, width = 0.1
, position = position_dodge(width=0.9))+
geom_text(aes(label = PECK_RATE), hjust = 0, size = 4) +
theme_classic() +
ylab("Mean Peck Rate (per min)") +
scale_colour_manual(values = cbPalette
, guide="none") +
scale_x_discrete(labels = c("Commercial Area"
, "Green Area")) +
theme(axis.title.x = element_blank()
, legend.position = "bottom"
, legend.box="vertical"
, legend.margin=margin()
, text = element_text(size = 18))
PECK.DOTPLOT
PECK.DOTPLOT<-ggplot(data = PECK.SUMMARY
, aes(x = GENERALIZED_ENVIRONMENT
, y = PECK_RATE
, color = GENERALIZED_ENVIRONMENT))+
geom_point(position = position_dodge(width = 0.9)
, size = 3) +
geom_errorbar(aes(ymin=(PECK_RATE-se)
, ymax=(PECK_RATE+se))
, width = 0.1
, position = position_dodge(width=0.9))+
geom_text(aes(label = PECK_RATE), hjust = 0.5, size = 4) +
theme_classic() +
ylab("Mean Peck Rate (per min)") +
scale_colour_manual(values = cbPalette
, guide="none") +
scale_x_discrete(labels = c("Commercial Area"
, "Green Area")) +
theme(axis.title.x = element_blank()
, legend.position = "bottom"
, legend.box="vertical"
, legend.margin=margin()
, text = element_text(size = 18))
PECK.DOTPLOT
PECK.DOTPLOT<-ggplot(data = PECK.SUMMARY
, aes(x = GENERALIZED_ENVIRONMENT
, y = PECK_RATE
, color = GENERALIZED_ENVIRONMENT))+
geom_point(position = position_dodge(width = 0.9)
, size = 3) +
geom_errorbar(aes(ymin=(PECK_RATE-se)
, ymax=(PECK_RATE+se))
, width = 0.1
, position = position_dodge(width=0.9))+
geom_text(aes(label = PECK_RATE), hjust = 1, size = 4) +
theme_classic() +
ylab("Mean Peck Rate (per min)") +
scale_colour_manual(values = cbPalette
, guide="none") +
scale_x_discrete(labels = c("Commercial Area"
, "Green Area")) +
theme(axis.title.x = element_blank()
, legend.position = "bottom"
, legend.box="vertical"
, legend.margin=margin()
, text = element_text(size = 18))
PECK.DOTPLOT
PECK.DOTPLOT<-ggplot(data = PECK.SUMMARY
, aes(x = GENERALIZED_ENVIRONMENT
, y = PECK_RATE
, color = GENERALIZED_ENVIRONMENT))+
geom_point(position = position_dodge(width = 0.9)
, size = 3) +
geom_errorbar(aes(ymin=(PECK_RATE-se)
, ymax=(PECK_RATE+se))
, width = 0.1
, position = position_dodge(width=0.9))+
geom_text(aes(label = PECK_RATE), hjust = 0.9, size = 4) +
theme_classic() +
ylab("Mean Peck Rate (per min)") +
scale_colour_manual(values = cbPalette
, guide="none") +
scale_x_discrete(labels = c("Commercial Area"
, "Green Area")) +
theme(axis.title.x = element_blank()
, legend.position = "bottom"
, legend.box="vertical"
, legend.margin=margin()
, text = element_text(size = 18))
PECK.DOTPLOT
PECK.DOTPLOT<-ggplot(data = PECK.SUMMARY
, aes(x = GENERALIZED_ENVIRONMENT
, y = PECK_RATE
, color = GENERALIZED_ENVIRONMENT))+
geom_point(position = position_dodge(width = 0.9)
, size = 3) +
geom_errorbar(aes(ymin=(PECK_RATE-se)
, ymax=(PECK_RATE+se))
, width = 0.1
, position = position_dodge(width=0.9))+
geom_text(aes(label = PECK_RATE), hjust = 0.7, size = 4) +
theme_classic() +
ylab("Mean Peck Rate (per min)") +
scale_colour_manual(values = cbPalette
, guide="none") +
scale_x_discrete(labels = c("Commercial Area"
, "Green Area")) +
theme(axis.title.x = element_blank()
, legend.position = "bottom"
, legend.box="vertical"
, legend.margin=margin()
, text = element_text(size = 18))
PECK.DOTPLOT
PECK.DOTPLOT<-ggplot(data = PECK.SUMMARY
, aes(x = GENERALIZED_ENVIRONMENT
, y = PECK_RATE
, color = GENERALIZED_ENVIRONMENT))+
geom_point(position = position_dodge(width = 0.9)
, size = 3) +
geom_errorbar(aes(ymin=(PECK_RATE-se)
, ymax=(PECK_RATE+se))
, width = 0.1
, position = position_dodge(width=0.9))+
geom_text(aes(label = round(PECK_RATE, 2)), hjust = 0.7, size = 4) +
theme_classic() +
ylab("Mean Peck Rate (per min)") +
scale_colour_manual(values = cbPalette
, guide="none") +
scale_x_discrete(labels = c("Commercial Area"
, "Green Area")) +
theme(axis.title.x = element_blank()
, legend.position = "bottom"
, legend.box="vertical"
, legend.margin=margin()
, text = element_text(size = 18))
PECK.DOTPLOT
PECK.DOTPLOT<-ggplot(data = PECK.SUMMARY
, aes(x = GENERALIZED_ENVIRONMENT
, y = PECK_RATE
, color = GENERALIZED_ENVIRONMENT))+
geom_point(position = position_dodge(width = 0.9)
, size = 3) +
geom_errorbar(aes(ymin=(PECK_RATE-se)
, ymax=(PECK_RATE+se))
, width = 0.1
, position = position_dodge(width=0.9))+
geom_text(aes(label = round(PECK_RATE, 2)), hjust = 0.5, size = 4) +
theme_classic() +
ylab("Mean Peck Rate (per min)") +
scale_colour_manual(values = cbPalette
, guide="none") +
scale_x_discrete(labels = c("Commercial Area"
, "Green Area")) +
theme(axis.title.x = element_blank()
, legend.position = "bottom"
, legend.box="vertical"
, legend.margin=margin()
, text = element_text(size = 18))
PECK.DOTPLOT
PECK.DOTPLOT<-ggplot(data = PECK.SUMMARY
, aes(x = GENERALIZED_ENVIRONMENT
, y = PECK_RATE
, color = GENERALIZED_ENVIRONMENT))+
geom_point(position = position_dodge(width = 0.9)
, size = 3) +
geom_errorbar(aes(ymin=(PECK_RATE-se)
, ymax=(PECK_RATE+se))
, width = 0.1
, position = position_dodge(width=0.9))+
geom_text(aes(label = round(PECK_RATE, 2)), hjust = 0, size = 4) +
theme_classic() +
ylab("Mean Peck Rate (per min)") +
scale_colour_manual(values = cbPalette
, guide="none") +
scale_x_discrete(labels = c("Commercial Area"
, "Green Area")) +
theme(axis.title.x = element_blank()
, legend.position = "bottom"
, legend.box="vertical"
, legend.margin=margin()
, text = element_text(size = 18))
PECK.DOTPLOT
PECK.DOTPLOT<-ggplot(data = PECK.SUMMARY
, aes(x = GENERALIZED_ENVIRONMENT
, y = PECK_RATE
, color = GENERALIZED_ENVIRONMENT))+
geom_point(position = position_dodge(width = 0.9)
, size = 3) +
geom_errorbar(aes(ymin=(PECK_RATE-se)
, ymax=(PECK_RATE+se))
, width = 0.1
, position = position_dodge(width=0.9))+
geom_text(aes(label = round(PECK_RATE, 2)), hjust = -0.1, size = 4) +
theme_classic() +
ylab("Mean Peck Rate (per min)") +
scale_colour_manual(values = cbPalette
, guide="none") +
scale_x_discrete(labels = c("Commercial Area"
, "Green Area")) +
theme(axis.title.x = element_blank()
, legend.position = "bottom"
, legend.box="vertical"
, legend.margin=margin()
, text = element_text(size = 18))
PECK.DOTPLOT
PECK.DOTPLOT<-ggplot(data = PECK.SUMMARY
, aes(x = GENERALIZED_ENVIRONMENT
, y = PECK_RATE
, color = GENERALIZED_ENVIRONMENT))+
geom_point(position = position_dodge(width = 0.9)
, size = 3) +
geom_errorbar(aes(ymin=(PECK_RATE-se)
, ymax=(PECK_RATE+se))
, width = 0.1
, position = position_dodge(width=0.9))+
geom_text(aes(label = round(PECK_RATE, 2)), hjust = -0.2, size = 8) +
theme_classic() +
ylab("Mean Peck Rate (per min)") +
scale_colour_manual(values = cbPalette
, guide="none") +
scale_x_discrete(labels = c("Commercial Area"
, "Green Area")) +
theme(axis.title.x = element_blank()
, legend.position = "bottom"
, legend.box="vertical"
, legend.margin=margin()
, text = element_text(size = 18))
PECK.DOTPLOT
PECK.DOTPLOT<-ggplot(data = PECK.SUMMARY
, aes(x = GENERALIZED_ENVIRONMENT
, y = PECK_RATE
, color = GENERALIZED_ENVIRONMENT))+
geom_point(position = position_dodge(width = 0.9)
, size = 3) +
geom_errorbar(aes(ymin=(PECK_RATE-se)
, ymax=(PECK_RATE+se))
, width = 0.1
, position = position_dodge(width=0.9))+
geom_text(aes(label = round(PECK_RATE, 2)), hjust = -0.2, size = 6) +
theme_classic() +
ylab("Mean Peck Rate (per min)") +
scale_colour_manual(values = cbPalette
, guide="none") +
scale_x_discrete(labels = c("Commercial Area"
, "Green Area")) +
theme(axis.title.x = element_blank()
, legend.position = "bottom"
, legend.box="vertical"
, legend.margin=margin()
, text = element_text(size = 18))
PECK.DOTPLOT
BOUT<-BOUT.raw %>%
filter(.
, DURATION > 0.01) %>% #Remove impossibly small values
filter(.
, BEHAVIOR != "M") #Remove "M"
BOUT$LDURATION<-log(BOUT$DURATION) #Transform data for normality
str(BOUT)
str(BOUT.raw)
BOUT.SUMMARY <- summarySE(data = BOUT
, measurevar = "DURATION"
, groupvars = c("GENERALIZED_ENVIRONMENT"
, "BEHAVIOR"
)
) %>%
mutate(BEHAVIOR = recode_factor(BEHAVIOR
,'HD' = 'Foraging'#Rename HD as 'foraging'
, 'HU' = 'Alert') #Rename HU as 'Alert'
)
BOUT.SUMMARY
BOUT.DOTPLOT<-BOUT.SUMMARY %>%
ggplot(.
, aes(x = GENERALIZED_ENVIRONMENT
, y = DURATION
, colour = GENERALIZED_ENVIRONMENT))+
geom_point(position = position_dodge(width = 0.9)
, size = 3) +
geom_errorbar(aes(ymin=(DURATION-se)
, ymax=(DURATION+se))
, width = 0.1
, position = position_dodge(width=0.9))+
geom_text(aes(label = round(DURATION, 2)), hjust = -0.2, size = 6) +
theme_classic() +
ylab("Mean Bout Duration (s)") +
scale_colour_manual(values = cbPalette
, guide="none") +
scale_x_discrete(labels = c("Commercial Area", "Green Area"))+
theme(axis.title.x = element_blank()
, legend.position = "bottom"
, legend.box="vertical"
, legend.margin=margin()
, text = element_text(size = 18)) +
facet_grid(~BEHAVIOR)
BOUT.DOTPLOT
